<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="ephemerallib">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="ephemerallib">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="dmmaze">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>ephemerallib</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">ephemerallib</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/01/28/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86C4-%E9%A2%91%E5%9F%9F%E6%BB%A4%E6%B3%A2-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="dmmaze">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ephemerallib">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/01/28/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86C4-%E9%A2%91%E5%9F%9F%E6%BB%A4%E6%B3%A2-1/" class="post-title-link" itemprop="url">图像处理C4-频域滤波</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-01-28 17:01:29 / Modified: 17:07:13" itemprop="dateCreated datePublished" datetime="2022-01-28T17:01:29+08:00">2022-01-28</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86/" itemprop="url" rel="index"><span itemprop="name">图像处理</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="单位脉冲与其筛选性质"><a href="#单位脉冲与其筛选性质" class="headerlink" title="单位脉冲与其筛选性质"></a>单位脉冲与其筛选性质</h1><p><strong>单位脉冲</strong> <em>unit impulse</em>是满足以下条件：</p>
<script type="math/tex; mode=display">
\delta(t) = \left\{\begin{aligned}
&0 \quad if  \ t \neq 0 \\ &1 \quad if \ t = 0
\end{aligned}
\right.</script><p>且满足约束$\int ^{\infty}_{-\infty}\delta(t)dt=1$的函数。因为这一积分所以单位脉冲有所谓的筛选性质：</p>
<script type="math/tex; mode=display">
\int^\infty_{-\infty}{\delta(t)f(t)dt}=f(0)</script><p>位于$t_0$点的单位脉冲写为$\delta(t-t_0)$，同理</p>
<script type="math/tex; mode=display">
\int^\infty_{-\infty}{\delta(t-t_0)f(t)dt}=f(t_0)</script><p><strong>脉冲序列</strong> <em>impulse train</em>是由间隔为$\triangle T$的无限个单位脉冲累加成的函数$s_{\triangle T}(t)$：</p>
<script type="math/tex; mode=display">
s_{\triangle T}(t) = \sum^\infty_{k=-\infty}\delta(t-k\triangle T)</script><p>同理对离散变量$x$，满足上面条件，约束条件：</p>
<script type="math/tex; mode=display">
\sum^\infty_{-\infty}\delta(x)=1</script><p>筛选性质：</p>
<script type="math/tex; mode=display">
\sum^\infty_{-\infty}\delta(x)f(x)=f(0)</script><h1 id="一元连续变量的傅里叶变换"><a href="#一元连续变量的傅里叶变换" class="headerlink" title="一元连续变量的傅里叶变换"></a>一元连续变量的傅里叶变换</h1><p>有限变量上的连续函数$f(t)$的傅里叶变换是关于频率$\mu$的函数，可以写作</p>
<script type="math/tex; mode=display">
F(\mu)=\mathcal{J}\{f(t)\} = \int^{\infty}_{-\infty}f(t)e^{-j2\pi\mu t}dt</script><p>逆傅里叶变换有：</p>
<script type="math/tex; mode=display">
f(t) = \mathcal{J}^{-1}\{f(\mu)\} = \int^{\infty}_{-\infty}f(t)e^{j2\pi\mu t}d\mu</script><p>两函数构成傅里叶变换对$f(t) \Leftrightarrow F(\mu)$，代入欧拉公式，傅里叶变换写成</p>
<script type="math/tex; mode=display">
F(\mu)=\int^\infty_{-\infty}f(t)[\cos({2\pi\mu t}) -j\sin({2\pi\mu t})]dt</script><p>所以$f(t)$的傅里叶变换就是它乘上一个正弦项的展开，这一正弦项的频率取决于$\mu$，积分后的变量也只剩下频率，所以将傅里叶变换的域称作频域。</p>
<h2 id="例1-盒形函数的傅里叶变换"><a href="#例1-盒形函数的傅里叶变换" class="headerlink" title="例1 盒形函数的傅里叶变换"></a>例1 盒形函数的傅里叶变换</h2><p><img src="/2022/01/28/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86C4-%E9%A2%91%E5%9F%9F%E6%BB%A4%E6%B3%A2-1/C4_1.jpg"></p>
<p>对图1傅里叶变换带入公式得：</p>
<script type="math/tex; mode=display">
F(\mu) = -\frac{A}{j2\pi\mu}[e^{-j2\pi \mu t}]^{W/2}_{-W/2}=AW\frac{\sin{(\pi W\mu)}}{\pi W \mu}</script><p>$F(\mu)$图像如图2，取绝对值的图像就是傅里叶频谱或频域<strong>频谱</strong>如图3$|F(\mu)|$，该函数值得注意的性质有</p>
<ol>
<li>所有零点值都是和原函数宽度$W$的倒数成比例的。</li>
<li>所有凸点的高度变化是关于横坐标的函数</li>
<li>该函数从负无穷延伸到正无穷</li>
</ol>
<h2 id="例2-单位脉冲及脉冲序列的傅里叶变换"><a href="#例2-单位脉冲及脉冲序列的傅里叶变换" class="headerlink" title="例2 单位脉冲及脉冲序列的傅里叶变换"></a>例2 单位脉冲及脉冲序列的傅里叶变换</h2><p>单位脉冲的傅里叶变换：</p>
<script type="math/tex; mode=display">
\mathcal{J}\{\delta(t-t_0)\} = e^{-j2\pi\mu t_0}</script><p>对于脉冲序列$s_{\triangle T}(t)$，其傅里叶集$S_{\triangle T}(t)$为</p>
<script type="math/tex; mode=display">
\sum^\infty_{n=-\infty}c_ne^{j2\pi n t / \triangle T},c_n=\frac{1}{\triangle T} \int^\infty_{-\infty}\delta(t)e^{-j2\pi nt / \triangle T}dt=\frac{1}{\triangle T}</script><p>对$S_{\triangle T}(t)$求傅里叶变换，由于该变换是线性的，所以结果等于对各项求变换再求和：</p>
<script type="math/tex; mode=display">
\mathcal{J}\{S_{\triangle T}(t)\}=\frac{1}{\triangle T}\sum^\infty_{n=-\infty}\mathcal{J}\{e^{j2\pi n t / \triangle T}\} \tag{4-1}</script><p>现有傅里叶变换对$f(t)\Leftrightarrow F(\mu)$，则对$F(t)$求傅里叶变换$\int^{\infty}_{-\infty}F(t)e^{-j2\pi\mu t}dt = f(-\mu)$。前面已算出$\mathcal{J}\{\delta(t-t_0)\} = e^{-j2\pi\mu t_0}$，$e^{-j2\pi\mu t_0}$的傅里叶变换是$\delta(-t-t_0)$（书上这里是$\delta(-\mu-t_0)$应该是错了），设$a=-t_0$，由于$\delta$有0以外值都为0的性质所以$\delta(-t+a)=\delta(t-a)$，因此$e^{j2\pi a \mu }$的傅里叶变换是$\delta(t-a)$，同理$e^{j2\pi at} \Leftrightarrow \delta(\mu-a)$</p>
<p>那么将$\mathcal{J}\{e^{j2\pi n t / \triangle T}\} = \delta(\mu - n/\triangle T)$带入(4-1)得到脉冲序列的傅里叶变换$S(\mu)$</p>
<script type="math/tex; mode=display">
S(\mu) = \frac{1}{\triangle T}\sum^{\infty}_{-\infty}\delta(\mu-n/\triangle T)</script><p>这一结果说明以$\triangle T$ 为周期的脉冲序列的傅里叶变换也是一个脉冲序列，周期为$\triangle T$</p>
<h1 id="卷积"><a href="#卷积" class="headerlink" title="卷积"></a>卷积</h1><p>已知傅里叶对为$h(t)\Leftrightarrow H(\mu)$，则对于函数$h(t-\tau)$，其傅里叶变换为：</p>
<script type="math/tex; mode=display">
\begin{aligned}
\mathcal{J}\{h(t-\tau)\} &= \int^{\infty}_{-\infty}h(t-\tau)e^{-j2\pi\mu t}dt 
\\&= e^{-j2\pi \mu \tau}\int^{\infty}_{-\infty}h(t-\tau)e^{-j2\pi\mu (t-\tau)}d(t-\tau) \\
&=e^{-j2\pi \mu \tau}H(\mu) 
\end{aligned}
\tag{4-2}</script><p>已知$f(t)\Leftrightarrow F(\mu), h(t)\Leftrightarrow H(\mu)$计算卷积$(f\ast h)(t)$的傅里叶变换：</p>
<script type="math/tex; mode=display">
\begin{aligned}
\mathcal{J}\{(f\ast h)(t)\} &=  \int^{\infty}_{-\infty} e^{-j2\pi\mu t} \left[\int^\infty_{-\infty}{f(\tau)h(t-\tau)} d\tau \right] dt \\
&= \int^{\infty}_{-\infty} f(\tau)\left[\int^\infty_{-\infty}{e^{-j2\pi\mu t}h(t-\tau)} dt \right] d\tau \\
&= \int^{\infty}_{-\infty} f(\tau)e^{-j2\pi \mu \tau}H(\mu) d\tau \qquad \text{(代入4-2)} \\
&=F(\mu)H(\mu) = F \cdot H(\mu)
\end{aligned}</script><p>可知，$(f\ast h)(t) \Leftrightarrow (F\cdot H)(\mu)$，两函数卷积的傅里叶变换等于它们各自的傅里叶变换的乘积。</p>
<p>同样地有$(f \cdot h)(t) \Leftrightarrow (F\ast H)(\mu)$。</p>
<p>频域中的卷积相当于空间域的乘积，频域中的乘积相当于空间域的卷积，这就是频域滤波的基本定理。</p>
<h1 id="采样和采样函数的傅里叶变换"><a href="#采样和采样函数的傅里叶变换" class="headerlink" title="采样和采样函数的傅里叶变换"></a>采样和采样函数的傅里叶变换</h1><h2 id="采样"><a href="#采样" class="headerlink" title="采样"></a>采样</h2><p>连续函数采样和量化后才能变成计算机能处理的离散值。对于连续函数$f(t)$，采样方法可以是乘上周期为$\triangle T$的脉冲序列。采样间隔的倒数$\frac{1}{\triangle T}$就是采样率。采样后的函数写作</p>
<script type="math/tex; mode=display">
\tilde{f}(t)=f(t)s_{\triangle T}(t)=\sum_{n=-\infty}^\infty f(t)\delta(t-n\triangle T)</script><p>利用脉冲序列的筛选性质，其中任意一份样本可以通过积分得到$f_k=\int^\infty_{-\infty}f(t)\delta(t-k\triangle T)=f(k\triangle T)$</p>
<h2 id="采样函数的傅里叶变换"><a href="#采样函数的傅里叶变换" class="headerlink" title="采样函数的傅里叶变换"></a>采样函数的傅里叶变换</h2><p>设$F(\mu)$是连续函数$f(t)$的傅里叶变换，脉冲序列$s_{\triangle T}$的傅里叶变换是$S(\mu)$，采样函数是$f$和脉冲序列的乘积，则采样函数的傅里叶变换就是$F(\mu)$和$S(\mu)$的卷积：</p>
<script type="math/tex; mode=display">
\tilde{F}(\mu) = \mathcal{J}\{\tilde{f}(t)\} = \mathcal{J}\{f(t)s_{\triangle T}\}=(F \ast S)(\mu)</script><p>带入之前求出的脉冲序列的傅里叶变换$S(\mu)=1/\triangle T\sum^\infty_{n=-\infty}\delta(\mu-n/\triangle T)$：</p>
<script type="math/tex; mode=display">
\begin{aligned}
(F\ast S)(\mu) &= \int^\infty_{-\infty}F(\tau)S(\mu-\tau)d\tau \\
&= 1/\triangle T\sum^\infty_{n=-\infty}\int F(\tau)\delta(\mu-n/\triangle T - \tau)d\tau \\
&= 1/\triangle T\sum^\infty_{n=-\infty}F(\mu-n/\triangle T)
\end{aligned}
\tag{4-3}</script><p>由结果可知，采样函数的傅里叶变换$\tilde{F}(\mu)$是一个原函数傅里叶变换的拷贝序列，拷贝间距由$1/\triangle T$决定。注意$\tilde{F}(\mu)$是连续函数。</p>
<p>下图1是$f(t)$的傅里叶变换函数图像$F(\mu)$，图二是采样率$1/\triangle T$足够大的点，样本之间还留有间隙，叫过采样，图3正好叫<em>critically sampling</em>，图四采样率不足没能保留原有变换因此叫欠采样。</p>
<p><img src="/2022/01/28/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86C4-%E9%A2%91%E5%9F%9F%E6%BB%A4%E6%B3%A2-1/C4_2.jpg"></p>
<h2 id="采样理论"><a href="#采样理论" class="headerlink" title="采样理论"></a>采样理论</h2><p>如函数$f(t)$的傅里叶变换函数在有限区间$[-\mu_{max}, \mu_{max}]$上有非零点，在该区间以外恒为零，那么$f(t)$就是有限带宽函数。当$\triangle T = \mu_{max}$时就是critically sampling，采样率只要满足$1/\triangle T \geq 2\mu_{max}$，就能通过从$\tilde{F}(\mu)$提取一个周期取出完整的$F(\mu)$，计算其逆傅里叶变换还原成原函数。</p>
<p>既对连续的<strong>有限带宽</strong>函数，只要采样率大于该函数内容的最高频率，就能从样本完整还原出原函数。</p>
<p>采样率正好等于$2\mu_{max}$时叫<strong>奈奎斯特采样率</strong> <em>Nyquist rate</em>。实际中一般要超过奈奎斯特采样率。</p>
<p>从上图3取出一个完整周期很简单，就是直接乘上盒形函数$H(u)$：</p>
<script type="math/tex; mode=display">
\begin{aligned}
H(\mu) &= \left\{
\begin{aligned}
&\triangle T \quad &-\mu_{max} \leq \mu \leq \mu_{max}\\
&0 \quad &otherwise
\end{aligned}
\right. \\
F(\mu) &= H(\mu)\tilde{F}(\mu) 
\end{aligned}</script><p>$\triangle T$是为了将(4-3)结果前的系数抵消。</p>
<p>函数$H(\mu)$是一个低通滤波器，也是理想的，硬件上实现从$\triangle T$到0的跳跃不可能。因为它是用来还原原函数的，这类滤波器又叫重建滤波器<em>reconstruction filters</em>。</p>
<h2 id="走样"><a href="#走样" class="headerlink" title="走样"></a>走样</h2><p>走样alias英文字面意思是假身份，信号处理领域专指采样后两种不同信号变得无法区分的现象，既一种信号冒充了另一种信号。</p>
<p><img src="/2022/01/28/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86C4-%E9%A2%91%E5%9F%9F%E6%BB%A4%E6%B3%A2-1/C4_3.jpg"></p>
<p>如图所示，走样通常在不同信号采样点的值相等时发生，这时对应的两连续函数叫走样对。</p>
<p>除了一些特殊情况外，走样总是会出现的，因为即使原函数是有限带宽的，限制函数区间（长度）仍会引入无无限的频率成分。如要限制一个函数$f(t)$到有限区间$[0, T]$，只要将其乘上对应的盒型函数$h(x)$，相当于在频域中进行卷积，盒型函数的傅里叶变换如前文是无限的，所以即使$F(\mu)$是有限带宽的，它的卷积结果也会有从负无穷延伸到正无穷的频率成分。相反地，有限带宽函数必然从负无穷延伸到正无穷。</p>
<p>一种特例是周期函数。</p>
<p>尽管有限长度信号的采样会不可避免产生走样，但是能在<strong>采样前</strong>削弱高频信号来减缓走样效果，这一过程叫反走样。</p>
<p><img src="/2022/01/28/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86C4-%E9%A2%91%E5%9F%9F%E6%BB%A4%E6%B3%A2-1/C4_4.jpg"></p>
<p>上图表明了高频信号欠采样会产生的走样现象。因此音频录制通常会先加低通滤波器滤去高于采样率一半的高频信号避免产生虚假的低频成分。</p>
<h2 id="根据样本数据进行函数重建"><a href="#根据样本数据进行函数重建" class="headerlink" title="根据样本数据进行函数重建"></a>根据样本数据进行函数重建</h2><p>实践中，从样本进行函数重建通常是通过插值完成的。</p>
<p>前文提到的重建过程是从频域乘上盒型函数得到完整周期$F(\mu) = H(\mu)\tilde{F}$，因此相应的有$f(t)=h(t)\ast \tilde{f}(t)$：</p>
<script type="math/tex; mode=display">
\begin{aligned}
f(t)&=h(t)\ast \tilde{f}(t) \\
&= \int^\infty_{-\infty}{h(\tau)\sum^\infty_{-\infty}f(t-\tau)\delta(t-\tau-n \triangle T)} d\tau  \\
&=\sum^\infty_{-\infty}h(t-n\triangle T)f(n\triangle T) \\
&= \sum^\infty_{-\infty}sinc[(t-n\triangle T)/\triangle T]f(n\triangle T)
\end{aligned}</script><p>理想盒型函数的逆傅里叶变换是$sinc$函数,$sinc(m) = \frac{\sin\pi m}{\pi m}$，该函数在零点值为1，其他整数点为0。则复原函数在整数点的值就等于样本值，其他点的值就是样本点的加权求和，也就是插值。这一结果表明样本间的值需要无限个样本进行插值才能求出，实际中是用有限个样本近似的。</p>
<h1 id="一元变量的离散傅里叶变换"><a href="#一元变量的离散傅里叶变换" class="headerlink" title="一元变量的离散傅里叶变换"></a>一元变量的离散傅里叶变换</h1><h2 id="从采样函数的连续变换获得离散傅里叶变换"><a href="#从采样函数的连续变换获得离散傅里叶变换" class="headerlink" title="从采样函数的连续变换获得离散傅里叶变换"></a>从采样函数的连续变换获得离散傅里叶变换</h2><p>后面连续函数统一用$f(t)$，离散函数统一用$f(x)$</p>
<p>离散函数的傅里叶变换是连续的，现在要推导离散傅里叶变换DFT，离散函数的傅里叶变换：</p>
<script type="math/tex; mode=display">
\begin{aligned}
\tilde{F}(\mu) &= \int^\infty_{-\infty}f(x)e^{-j2\pi \mu x} \\
&= \sum^{\infty}_{x=-\infty}f_n e^{-j2\pi \mu x\triangle T}
\end{aligned}</script><p>由结果可知$\tilde{F}$是个连续周期函数，周期$1/\triangle T$。所以只需要取出一个周期就能描述$\tilde{F}(\mu)$，现在在$[0, 1/\triangle T]$上等间距采样$M$个点，既取频率$\frac{\mu}{M\triangle T}, \mu=0,1,\cdots,M-1$，带入得到离散傅里叶变换表达式：</p>
<script type="math/tex; mode=display">
F_\mu = \sum^{M-1}_{n=0}f_xe^{-j2\pi \mu x / M}</script><p>相应地可以计算离散傅里叶变换IDFT：</p>
<script type="math/tex; mode=display">
f_x = 1/M \sum^{M-1}_{m=0}F_\mu e^{j2\pi \mu x/M}</script><p>带入上上式显然成立，则它们构成了离散傅里叶变换对，而且这表明对任意有限i连续样本点，傅里叶和逆傅里叶变换都是存在的。</p>
<p>注意采样区间取$[0, 1/\triangle T]$是对两相邻变换的半周期进采样，结果是频率较低的半周期出现在较高的采样点，以后会讨论如何排序。</p>
<p>易证$f(x-x_0)\Leftrightarrow F(\mu)e^{-j2\pi \mu x_0 /M}$，离散形式的卷积：</p>
<script type="math/tex; mode=display">
f(x) \ast h(x) = \sum^{M-1}_{m=0}f(m)h(x-m)</script><p>同样满足前面提到的卷积定理。</p>
<h2 id="采样和频率间隔的关系"><a href="#采样和频率间隔的关系" class="headerlink" title="采样和频率间隔的关系"></a>采样和频率间隔的关系</h2><p>如果$f(x)$由$M$个间隔为$\triangle T$的样本点组成，那么长度$T=M\triangle T$，相应的频率间隔$\triangle \mu = \frac{1}{M \triangle T}$，频域范围是$\frac{1}{\triangle T}$</p>
<h1 id="二元离散傅里叶变换"><a href="#二元离散傅里叶变换" class="headerlink" title="二元离散傅里叶变换"></a>二元离散傅里叶变换</h1><p>二元离散形式的单位脉冲：</p>
<script type="math/tex; mode=display">
\delta(x, y) = 
\left\{
\begin{aligned}
&1 &\quad if \ x=y=0\\
&0 &otherwise
\end{aligned}
\right.</script><p>它的筛选性质满足</p>
<script type="math/tex; mode=display">
\sum^{\infty}_{x=-\infty}\sum^{\infty}_{y=-\infty}f(x, y)\delta(x,y)=f(0, 0)</script><p>二维离散傅里叶变换和逆傅里叶变换分别为：</p>
<script type="math/tex; mode=display">
\begin{aligned}
F(u, v) &= \sum^{M-1}_{x=0}\sum^{N-1}_{y=0}f(x,y)e^{-j2\pi(ux + zy)} \\
f(x, y) &= \frac{1}{MN}\sum^{M-1}_{x=0}\sum^{N-1}_{y=0}F(u,v)e^{j2\pi(ux + zy)}
\end{aligned}</script><p>类似的，如果满足$1/\triangle T &gt; 2\mu_{max}, 1/\triangle Z &gt; 2v_{max}$，也能说采样结果没有信息缺失。</p>
<h2 id="二维走样"><a href="#二维走样" class="headerlink" title="二维走样"></a>二维走样</h2><p>二维走样主要分两种：空间走样和时间走样。前者主要是单张图像的欠采样，是本节关注的内容，后者是指序列动态图像由于在时间上采样率不足造成的走样现象，如fps不足的视频高速转动的轮胎会倒转。</p>
<p>以斜的平行线为例，采样率维持不变，高频内容（线条细而密）采样后的锯齿（走样的一种）现象较严重，低频内容（线条宽）走样较轻。</p>
<p>以采样黑白格棋盘为例，固定采样的图像尺寸为$96\times 96$像素，那么只要满足棋盘频率$\mu &lt; 1/2  \ circle /pixel$，既棋盘格子的大小小于一个像素，就不会发生走样。</p>
<p><img src="/2022/01/28/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86C4-%E9%A2%91%E5%9F%9F%E6%BB%A4%E6%B3%A2-1/C4_5.jpg"></p>
<p>以上原棋盘格子尺寸分别为16，6，0.95，0.48。注意图四虽然看起来正常但其实是错的，这表明走样可能会产生看似正常的欺骗性结果。</p>
<p>严格来说反走样技术是用在采样前的，如一些摄像头会有削弱高频信号的滤镜</p>
<h1 id="2D傅里叶变换和逆傅里叶变换的性质"><a href="#2D傅里叶变换和逆傅里叶变换的性质" class="headerlink" title="2D傅里叶变换和逆傅里叶变换的性质"></a>2D傅里叶变换和逆傅里叶变换的性质</h1><p>频域间隔和空间域间隔的关系和1D一样。</p>
<h2 id="旋转和平移"><a href="#旋转和平移" class="headerlink" title="旋转和平移"></a>旋转和平移</h2><p>易证</p>
<script type="math/tex; mode=display">
\begin{aligned}
f(x,y)e^{j2\pi(u_0x/M+v_0y/N)} &\Leftrightarrow F(u-u_0, v-v_0) \\
f(x-x_0,y-y0) &\Leftrightarrow F(u, v)e^{-j2\pi(u_0x/M+v_0y/N)}
\end{aligned}</script><p>将$f(x,y)$转为极坐标表示$f(r, \theta)$，乘上$e^{-j2\pi(u_0x/M+v_0y/N)}$相当于旋转对应的角度$\theta_0$，$f(r,\theta+\theta_0)\Leftrightarrow F(\omega,\varphi+\theta_0)$。</p>
<p>前面提到取采样区间$[0, T]$取出的实际是两个相邻半周期。现在要将频域图像右移半个周期，就能取出一个完整周期，由上述平移公式得$F(u-M/2) = f(x)e^{j\pi x} = f(x)(-1)^x$，同理二维需要在计算傅里叶变换前平移成$f(x, y)(-1)^{(x+y)}$</p>
<h2 id="对称性质"><a href="#对称性质" class="headerlink" title="对称性质"></a>对称性质</h2><p>对于离散序列，对称是根据序列中心点来的，此时奇偶函数分别有以下对称性和反对称性</p>
<script type="math/tex; mode=display">
\begin{aligned}
w_o(x, y) &= -w_o(M-x, N-y) \\
w_e(x, y) &= w_o(M-x, N-y)
\end{aligned}</script><h3 id="例-序列奇偶性测试"><a href="#例-序列奇偶性测试" class="headerlink" title="例 序列奇偶性测试"></a>例 序列奇偶性测试</h3><p>序列$f=\{2, 1, 1, 1\}$(下标从0开始)是偶序列，满足$f(x)=f(4-x)$，对于特殊下标0，因为$f(4)$看作不存在，所以$f(0)$<u>取值不会影响偶性判定结果</u>。而偶序列对于$$同样可以取任意值。</p>
<p>序列$g=\{0,-1,0,1\}$是奇序列，要求奇序列$g(0),g(M/2)$必取0。</p>
<h2 id="傅里叶频谱和相位角"><a href="#傅里叶频谱和相位角" class="headerlink" title="傅里叶频谱和相位角"></a>傅里叶频谱和相位角</h2><p>2D傅里叶变换结果一般是复函数：</p>
<script type="math/tex; mode=display">
F(u,v) = R(u,v) + jI(u,v)=|F(u,v)|e^{j\phi(u,v)}</script><p>强度，亦称傅里叶频谱<em>(or frequency)spectrum</em>：</p>
<script type="math/tex; mode=display">
|F(u,v)|=[R^2(u,v)+I^2(u,v)]^{1/2}</script><p>相位角/相位频谱<em>phase angle/phase spectrum</em>：</p>
<script type="math/tex; mode=display">
\phi(u,v)=\arctan(\frac{I(u,v)}{R(u,v)})</script><p>最后，<em>power spectrum</em>：</p>
<script type="math/tex; mode=display">
P(u,v)=|F(u,v)|^2=R^2(u,v)+I^2(u,v)</script><p>易证实值函数的傅里叶变换满足$|F(u,v)|=|F(-u,-v)|$，相位角是关于原点的奇函数$\phi(u,v)=-\phi(-u,-v)$。直接求零点的傅里叶变换可以得到$F(0, 0) = \sum^{M-1}_{x=0}\sum^{N-1}_{y=0}f(x,y)=MN\tilde{f}$，$\tilde{f}$是所有$f(x,y)$的均值。因为$MN$是相对较大的，所以一般$|F(0, 0)|$就是频谱中亮度最大的成分。$F(0,0)$是又叫变换的<em>dc component</em>（”dc” signifies direct current，current of zero frequency）。</p>
<p>频谱记录了某种频率在原图中的显著程度，包含了原图的亮度信息，相位包含了不同正弦曲线相对原点的偏移量，记录了形状信息。</p>
<h2 id="2D离散卷积定理"><a href="#2D离散卷积定理" class="headerlink" title="2D离散卷积定理"></a>2D离散卷积定理</h2><p>2D离散卷积和乘积有以下关系：</p>
<script type="math/tex; mode=display">
\begin{aligned}
(f\ast h)(x,y) &\Leftrightarrow (F \cdot H)(u,v) \\
(f\cdot h)(x,y) &\Leftrightarrow \frac{1}{MN}(F \ast H)(u,v)
\end{aligned}</script><p>实际上，由于逆傅里叶变换结果会是周期函数，所以想通过卷积定理在频域计算乘积再逆傅里叶变换，等价于在空间域对两个周期化的原图进行卷积，发生wraparound error。</p>
<p><img src="/2022/01/28/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86C4-%E9%A2%91%E5%9F%9F%E6%BB%A4%E6%B3%A2-1/C4_6.jpg"></p>
<p>左列是直接对一维函数$f, h$进行卷积，右列是使用离散傅里叶变换和卷积定理得到的结果。</p>
<p>这一错误可以通过zero padding来避免，将两原函数都垫到尺寸$P\geq A+B-1$，$A,B$分别是原函数尺寸，0可以垫到头也可以垫到尾，2D图像同理</p>
<h1 id="频域滤波基础"><a href="#频域滤波基础" class="headerlink" title="频域滤波基础"></a>频域滤波基础</h1><p>因为$F(u,v)$每项都包括了$f(x,y)$所有值之和，所以一般很难直接将图像某部分和变换结果联系起来，但是由于频率就是亮度在空间上的变化率，所以和图像中的亮度变化模式相关。</p>
<p>变换图像原点是和图像亮度均值成比例的，原点附近的低频段对应着图像中亮度变化缓慢的成分，如一张室内照，可能对应亮度过渡平滑的墙和地板，远离原点的高频段对应快速变化的部分，如边缘和其它亮度急剧变化的部分。</p>
<p><img src="/2022/01/28/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86C4-%E9%A2%91%E5%9F%9F%E6%BB%A4%E6%B3%A2-1/C4_7.jpg"></p>
<p>上图变换中较为显著的$\pm 45^\circ$成分对应着原图许多呈对角分布的边。</p>
<h2 id="使用低通频域滤波平滑图像"><a href="#使用低通频域滤波平滑图像" class="headerlink" title="使用低通频域滤波平滑图像"></a>使用低通频域滤波平滑图像</h2><p>下面介绍三种低通滤波器：<em>ideal, Butterworth, Gaussian</em>。下面统一输入是pad过的图像，宽高$P \times Q$</p>
<h3 id="理想低通滤波器"><a href="#理想低通滤波器" class="headerlink" title="理想低通滤波器"></a>理想低通滤波器</h3><p>简称ILPF。</p>
<script type="math/tex; mode=display">
H(u,v)=\left\{
\begin{aligned}
1 \quad&if \ D(u,v)\leq D_0\\
0 \quad&if \ D(u,v) > D_0
\end{aligned}
\right.</script><p>$D(u,v)$是变换图像$u,v$点到中心的欧几里得距离$D(u,v)=[(u-P/2)^2+(v-Q/2)^2]^{1/2}$</p>
<p>“理想”是因为这种滤波器没有过渡，直接截断某区间频率以外的值为0。</p>
<p><img src="/2022/01/28/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86C4-%E9%A2%91%E5%9F%9F%E6%BB%A4%E6%B3%A2-1/C4_8.jpg"></p>
<p>如图对$688\times 688$的图像进行频域滤波，截断频率选取以原点为圆心，半径分别为10，30，60，160，460。</p>
<p>结果的”ringing”现象可以用卷积理论解释：</p>
<p><img src="/2022/01/28/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86C4-%E9%A2%91%E5%9F%9F%E6%BB%A4%E6%B3%A2-1/C4_9.jpg"></p>
<p>图二是理想滤波器图1的逆傅里叶变换结果，在频域和图1滤波等价于和图2卷积，对单位脉冲的卷积就相当于将卷积核复制到该脉冲位置，所以会产生ringing效果。</p>
<h3 id="高斯低通滤波器"><a href="#高斯低通滤波器" class="headerlink" title="高斯低通滤波器"></a>高斯低通滤波器</h3><p><img src="/2022/01/28/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86C4-%E9%A2%91%E5%9F%9F%E6%BB%A4%E6%B3%A2-1/C4_10.jpg"></p>
<p>理想低通滤波器是关于到图像中心距离的函数：</p>
<script type="math/tex; mode=display">
H(u,v) = e^{-D^2(u,v)/2\sigma^2}</script><p>一般将$\sigma$写成$D_0$，作为高斯低通滤波器的截断频率。这种滤波器没有”ringing”的结果，代价是对频率过滤更不可控</p>
<h3 id="BUTTERWORTH低通滤波器"><a href="#BUTTERWORTH低通滤波器" class="headerlink" title="BUTTERWORTH低通滤波器"></a>BUTTERWORTH低通滤波器</h3><script type="math/tex; mode=display">
H(u,v) = \frac{1}{1+[D(u,v)/D_0]^{2n}}</script><p><img src="/2022/01/28/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86C4-%E9%A2%91%E5%9F%9F%E6%BB%A4%E6%B3%A2-1/C4_11.jpg"></p>
<p>butterworth关于n的曲线如图3所示，n越大就越接近理想低通滤波器。</p>
<p>低通滤波器的应用实例有OCR预处理，给化妆品广告人像磨皮等</p>
<h2 id="高通滤波器"><a href="#高通滤波器" class="headerlink" title="高通滤波器"></a>高通滤波器</h2><p>可以通过减去前面的低通滤波器直接得到对应的高通滤波器：</p>
<script type="math/tex; mode=display">
\begin{aligned}
IHPF(u,v)&=\left\{
\begin{aligned}
0 \quad&if \ D(u,v)\leq D_0\\
1 \quad&if \ D(u,v) > D_0
\end{aligned}
\right.\\
GHPF(u,v)&=1-e^{-D^2(u,v)/2D_0^2} \\
BHPF(u,v)&=\frac{1}{1+[D_0/D(u,v)]^{2n}}
\end{aligned}</script><h3 id="频域拉普拉斯变换"><a href="#频域拉普拉斯变换" class="headerlink" title="频域拉普拉斯变换"></a>频域拉普拉斯变换</h3><p>其频域函数为：</p>
<script type="math/tex; mode=display">
H(u,v)=-4\pi^2(u^2+v^2)=-4\pi D^2</script><p>而图像的拉普拉斯变换可以写作：</p>
<script type="math/tex; mode=display">
\nabla^2f(u,v)=S^{-1}[H(u,v)F(u,v)]</script><p>之前提到的锐化增强写作：</p>
<script type="math/tex; mode=display">
g(x,y) = f(x, y) - \nabla^2f(x,y)=S^{-1}\{[1+4\pi^2D^2(u,v)]F(u,v)\}</script><p>频域的拉普拉斯滤波比空间域卷积拉普拉斯核效果好，因为是对整个图像的像素点做的滤波。</p>
<h1 id="快速傅里叶变换"><a href="#快速傅里叶变换" class="headerlink" title="快速傅里叶变换"></a>快速傅里叶变换</h1><p>傅里叶变换是可分的：</p>
<script type="math/tex; mode=display">
F(u, v) = \sum^{M-1}_{x=0}e^{-j2\pi ux/M}\sum^{N-1}_{y=0}f(x,y)e^{-j2\pi vy/N}</script><p>所以可以将内层求和看作对每一行的变换，所以原来的二维变量运算就化简成两次相继的一维变换。</p>
<p>下面在一元变量的基础上介绍一种FFT算法推导，它要求$M$是2的幂次：</p>
<p>设$W_M = e^{-j2\pi/M}, M=2^p$：</p>
<script type="math/tex; mode=display">
\begin{aligned}
F(u) &= \sum^{M-1}_{x=0}f(x)W^{ux}_{M} \\
&=\sum^{K-1}_{x=0}f(2x)W^{u(2x)}_{2K}+\sum^{K-1}_{x=0}f(2x+1)W^{u(2x+1)}_{2K}
\end{aligned}</script><p>易得$W^{2ux}_{2K}=W^{ux}_{K}$，设$F_{even}(u)=\sum^{K-1}_{x=0}f(2x)W^{ux}_K, F_{odd}(u)=\sum^{K-1}_{x=0}f92x+1)W^{ux}_K$，上式可以写成：</p>
<script type="math/tex; mode=display">
F(u) = F_{even}(u)+F_{odd}(u)W^u_{2K}</script><p>又因为$W^{u+K}_M = e^{-j2\pi (u+K)/2K}=e^{-j2\pi u /K} = W^u_K$，$W^{u+K}_{2K} =-W^u_{2K}$，那么：</p>
<script type="math/tex; mode=display">
F(u+K)=F_{even}(u)-F_{odd}(u)W^u_{2K}</script><p>也就是说求解一维fft可以分解成2部分：先求解出前半部分，然后带入上式求后半部分</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/12/01/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86C3-%E5%9B%BE%E5%83%8F%E5%A2%9E%E5%BC%BA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="dmmaze">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ephemerallib">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/12/01/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86C3-%E5%9B%BE%E5%83%8F%E5%A2%9E%E5%BC%BA/" class="post-title-link" itemprop="url">图像处理C3-图像增强</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2021-12-01 18:27:13 / Modified: 19:07:47" itemprop="dateCreated datePublished" datetime="2021-12-01T18:27:13+08:00">2021-12-01</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86/" itemprop="url" rel="index"><span itemprop="name">图像处理</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>空间域<em>spatial domain</em>指的就是图像平面本身，本节介绍直接对其像素点的处理方法。</p>
<h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><h2 id="亮度变换和空间滤波基础"><a href="#亮度变换和空间滤波基础" class="headerlink" title="亮度变换和空间滤波基础"></a>亮度变换和空间滤波基础</h2><p>空间域操作的基础表达式：</p>
<script type="math/tex; mode=display">
g(x,y) = T(f(x,y))</script><p>$f,g$是输入输出图像，$T$是定义在$(x, y)$领域上的操作符。如果$T$操作的领域只有一个点$(x,y)$，$T$就是一个亮度变换函数<em>intensity transformation(<u>就是个映射函数</u>)</em>，用$r, s$表示输入输出亮度值：</p>
<script type="math/tex; mode=display">
s = T(r)</script><p>例子是阈值分割，将高于亮度阈值的像素点置为255否则置零，得到一张二值化非黑即白的图片。</p>
<h1 id="一些基础亮度变换函数"><a href="#一些基础亮度变换函数" class="headerlink" title="一些基础亮度变换函数"></a>一些基础亮度变换函数</h1><p>因为处理的是离散亮度点，因此可以将亮度变换函数用一个映射表表示。</p>
<p>下图中的曲线都被放缩到了同一范围内，只代表曲线形状，不能表示它们间的相对大小。</p>
<p><img src="/2021/12/01/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86C3-%E5%9B%BE%E5%83%8F%E5%A2%9E%E5%BC%BA/C3_1.jpg"></p>
<h2 id="对数变换"><a href="#对数变换" class="headerlink" title="对数变换"></a>对数变换</h2><script type="math/tex; mode=display">
s = c\log(1+r)</script><p>由上图对数曲线可知，亮度较小的输入映射后被铺到了更大的数值范围，较大的亮度输入映射后的范围被“压缩”了。指数变换<em>Inverse log</em>的特征正好相反。傅里叶变换得到的频谱图亮度值能达到$10^6$，对这类亮度值有着很大动态范围的图像可视化可以利用对数变换的压缩特性。</p>
<p><img src="/2021/12/01/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86C3-%E5%9B%BE%E5%83%8F%E5%A2%9E%E5%BC%BA/C3_cheem_log.jpg"></p>
<h2 id="幂次变换"><a href="#幂次变换" class="headerlink" title="幂次变换"></a>幂次变换</h2><script type="math/tex; mode=display">
s = cr^\gamma</script><p>$c$和$\gamma$是常数，有时写作$s=c(r+\epsilon)$。选定参数后幂次变换也有类似对数变换压缩-铺开的特性，修改$c,\gamma$能得到上图中对应的曲线族。很多捕捉、打印、显示设备响应满足一个幂次方程，将这一方程的幂次项统一称作gamma，对图像进行幂次变换得到更忠实图像的手段叫<em>伽马矫正</em>，如某crt设备电压响应的伽马值为$2.5$结果会偏暗，可以对图像做$\gamma=0.4$的幂次变换。</p>
<p>曝光不足的图片可以选小于1的$\gamma$值提升暗部细节，过曝的图片选大于1的$\gamma$值提升对比度。</p>
<h2 id="分段线性变换函数"><a href="#分段线性变换函数" class="headerlink" title="分段线性变换函数"></a>分段线性变换函数</h2><p><img src="/2021/12/01/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86C3-%E5%9B%BE%E5%83%8F%E5%A2%9E%E5%BC%BA/C3_2.jpg"></p>
<p>映射曲线如图1。图二是输入$f$，图三$s_1 = 0, s_2=L,r_1=\min(r), r_2=\max(r)$，做了一个把图像亮度铺到整个亮度等级的变换。</p>
<h2 id="直方图处理"><a href="#直方图处理" class="headerlink" title="直方图处理"></a>直方图处理</h2><p>输入$M\times N$图像亮度$k\in{0, 1, 2, \cdots,L-1}$，亮度为$k$的像素点有$n_k$个，它的归一化直方图为：</p>
<script type="math/tex; mode=display">
p_r(r_k) = \frac{n_k}{MN}</script><p>$p_r$又可近似看作亮度为$k$的点出现在图像中的概率。</p>
<h3 id="直方图均衡化"><a href="#直方图均衡化" class="headerlink" title="直方图均衡化"></a>直方图均衡化</h3><p>对于任意满足严格单调递增，变换前后区间都在$[0, L-1]$内的变换函数，变换前后亮度值的概率密度函数有以下关系：</p>
<script type="math/tex; mode=display">
\int_0^{r_0} p_r(r)dr = \int^{s_0}_0p_s(s)ds\Rightarrow p_s(s) = p_r(r)\frac{dr}{ds} \label{XX}\tag{3-1}</script><p>定义变换：</p>
<script type="math/tex; mode=display">
s = T(r) = (L-1)\int^r_0p_r(w)dw</script><p>可知$\frac{dr}{ds} = \frac{1}{(L-1)p_r(r)}$，带入公式$(\text{3-1})$得$p_s(s) = \frac{1}{L-1}$，既变换后图像中的亮度是均匀分布的。这一变换又叫直方图均衡化。离散形式：</p>
<script type="math/tex; mode=display">
s_k = (L-1)\sum^r_{k=0}p_r(k)</script><p><img src="/2021/12/01/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86C3-%E5%9B%BE%E5%83%8F%E5%A2%9E%E5%BC%BA/C3_cheem_eq.jpg"></p>
<h3 id="直方图匹配"><a href="#直方图匹配" class="headerlink" title="直方图匹配"></a>直方图匹配</h3><p>定义直方图均衡化的变换为$s_r=T(r)$，再定义一种pdf为$p_z(z)$的结果到$s$的变换为</p>
<script type="math/tex; mode=display">
s = G(z) = \int^z_0p_z(w)dw \Rightarrow z = G^{-1}(s)</script><p>如果要指定变换后的直方图形状，即$p_z(z)$，那么$r\mapsto z$可以按照以下步骤进行：</p>
<ol>
<li>从原图计算$p_r(r)$，求出均衡化结果$p_r(s)$</li>
<li>求出从$p_z(z)$到$p_s(s)$的逆变换，既$z=G^{-1}(s)$</li>
</ol>
<p>虽然可以将$r\mapsto z$直接表示出来，但是求解通常并不简单。但由于处理的图像是离散值：</p>
<script type="math/tex; mode=display">
\hat{s}_k = G(z_k) = (L-1)\sum^k_{z=0}p_z(z)</script><p>实际求解$r\mapsto z$不计算$G^{-1}$，步骤2替换为：</p>
<ol>
<li>按上式求出所有$\hat{s}_k \mapsto \hat{z}_k$</li>
<li>均衡化后的图像对某一亮度$s_k$找出最近的$\hat{s}_k$，该值对应有映射$\hat{s}_k \mapsto z_k$。构造映射表记录所有$k$值的映射关系$s_k \mapsto z_k$。</li>
</ol>
<p>实际可以不用求过渡的均衡化直接按上面方法求$r_k \mapsto z_k$</p>
<h3 id="精确直方图匹配"><a href="#精确直方图匹配" class="headerlink" title="精确直方图匹配"></a>精确直方图匹配</h3><p>前面不论是匹配还是均衡化得到的直方图形状都不是和目标直方图一模一样的，因其方法本质是移动直方图上的垂线。</p>
<p>精确直方图匹配能保证变换后的直方图形状与目标直方图一样。</p>
<p>现在某图像的非正规化直方图为$H = \{h(0), \cdots ,h(L-1)\}$满足$\sum^{L-1}_{j=0}h(j)=MN$，它的精确直方图匹配分为以下三步：</p>
<ol>
<li>按照某一<strong>标准</strong>对图像中的像素点进行排序</li>
<li>将排好序的像素点分为$L$个群使得第$j$群有$h(j)$个像素点</li>
<li>将$j$群的所有像素点亮度赋值为$j$</li>
</ol>
<p>排序标准需要保证变换能保留像素点间亮度的大小关系，但由于亮度值是有限的所以一般做不到保证像素点间严格的顺序关系，折衷的方法是求像素点的$k$近邻均值来排序。</p>
<p>如果原图有大面积亮度相等的色块，那么对这部分像素点进行排序是无意义的，这时精确直方图匹配可能会产生不想要的效果。但可以mask掉这部分像素点，只对余下像素点进行操作。</p>
<h3 id="局部直方图匹配"><a href="#局部直方图匹配" class="headerlink" title="局部直方图匹配"></a>局部直方图匹配</h3><p>扫描图像中的所有像素点，每次只对当前像素点的邻域进行直方图处理。</p>
<h3 id="利用直方图统计数据进行变换"><a href="#利用直方图统计数据进行变换" class="headerlink" title="利用直方图统计数据进行变换"></a>利用直方图统计数据进行变换</h3><p>可以求出图像的全局均值和标准差$\mu_G, \sigma_G$，对每个像素点$(x,y)$求出其领域内的局部均值和标准差</p>
<p>$\mu_{(x,y)},\sigma_{(x,y)}$。现在要让左图四角黑块内的图案变亮些</p>
<p><img src="/2021/12/01/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86C3-%E5%9B%BE%E5%83%8F%E5%A2%9E%E5%BC%BA/C3_3.jpg"></p>
<p>令$f(x,y)$是原图$(x,y)$处的亮度值，$g(x,y)$是变换后对应点亮度值，$C,k_0,k_1,k_2,k_3$是提前指定常数：</p>
<script type="math/tex; mode=display">
g(x, y) = \left\{
\begin{aligned}
&Cf(x, y) \quad if \ k_0\mu_G\leq\mu_{(x,y)}\leq k_1\mu_G \ and \ k_2\sigma_G\leq\sigma_{(x,y)}\leq k_3\sigma_G\\
&f(x,y) \quad otherwise
\end{aligned}
\right.</script><p>书中要得到右图取$k_0=k_2=0,k_1=k_3=0.1,C=20$，这样一来黑块内的图案亮度就被放大了。</p>
<h1 id="空间滤波基础"><a href="#空间滤波基础" class="headerlink" title="空间滤波基础"></a>空间滤波基础</h1><p>滤波器<em>filter</em>一词是从频域处理借来的。“过滤”<em>filtering</em>指的是对特定频率信号的操作。只允许低频信号通过的叫低通滤波器<em>lowpass filter</em>，对图像应用的效果是使其变模糊。</p>
<h2 id="线性空间滤波"><a href="#线性空间滤波" class="headerlink" title="线性空间滤波"></a>线性空间滤波</h2><p>线性空间滤波是在输入图像$f$所有像素点$(x,y)$和一个矩阵$w$间进行的乘积和运算：</p>
<script type="math/tex; mode=display">
\begin{aligned}
correlation: \quad g(x,y)=(w \star f)(x,y)=\sum^a_{s=-a}\sum^b_{t=-b}w(s,t)f(x+s,y+t) \\
convolution: \quad g(x,y)=(w \ast f)(x,y) = \sum^a_{s=-a}\sum^b_{t=-b}w(s,t)f(x-s,y-t)
\end{aligned}</script><p>$w$的大小决定了每次运算的邻域大小(上式宽高分辨是$2a+1,2b+1$，这种空间滤波核的别称有<em>mask, template, window, or simply kernel</em>，下面简称为滤波器。</p>
<p>这一运算叫<strong><em>Correlation（卷积神经网络直接叫卷积）</em></strong>，<strong>卷积</strong>和它唯一的区别是会将滤波器旋转180°。设滤波器大小为$s\times s$，为保证运算前后大小不变会在图像边缘添$(s-1)/2$个常数值，通常是0。</p>
<p>以一维卷积为例，下面说明卷积核correlation区别：</p>
<p>滤波器：1 2 4 2 8，卷积相当于旋转180°用8 2 4 2 1做互相关</p>
<p>输入一维图像：0 0 0 1 0 0 0 0，padding后为0 0 0 0 0 <strong>1</strong> 0 0 0 0 0 0</p>
<p>correlation运算结果：0 8 2 <strong>4</strong> 2 1 0 0</p>
<p>卷积结果：0 1 2 <strong>4</strong> 2 8 0 0</p>
<p>从结果来看，卷积就是滤波器$w$在输入图像上的平移，使其中心点<strong>4</strong>与原输入<strong>1</strong>的位置重合。correlation结果会将卷积核旋转180°。</p>
<p>推广到输入2D图像：</p>
<script type="math/tex; mode=display">
\begin{aligned}
&input &kernel\\ 
&\begin{matrix}
0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 \\
0 & 0 & 1 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0
\end{matrix}
&\begin{matrix}
1 & 2 & 3 \\
4 & 5 & 6 \\
7 & 8 & 9 
\end{matrix}
\end{aligned}</script><script type="math/tex; mode=display">
\begin{aligned}
&correlation \ result &convolution \ result \\
&\begin{matrix}
0 & 0 & 0 & 0 & 0 \\
0 & 9 & 8 & 7 & 0 \\
0 & 6 & 5 & 4 & 0 \\
0 & 3 & 2 & 1 & 0 \\
0 & 0 & 0 & 0 & 0
\end{matrix} 
&\begin{matrix}
0 & 0 & 0 & 0 & 0 \\
0 & 1 & 2 & 3 & 0 \\
0 & 4 & 5 & 6 & 0 \\
0 & 7 & 8 & 9 & 0 \\
0 & 0 & 0 & 0 & 0
\end{matrix}
\end{aligned}</script><p>如果滤波器是中心对称的，卷积和correlation结果相等。</p>
<p>强度<em>amplitude</em>为$A$，位置为$(x_0,y_0)$的脉冲<em>impulse</em>是满足以下条件的2D图像</p>
<script type="math/tex; mode=display">
\delta(x-x_0,x-y_0) = \left\{
\begin{aligned}
&A \quad if \ x=x_0 \ and \ y=y_0\\
&0 \quad otherwise
\end{aligned}
\right.</script><p>$A=1$时叫单位脉冲，对单位脉冲做卷积就是把滤波器平移到脉冲图像上使其中心与脉冲位置重合。</p>
<p>卷积和correlation满足以下运算性质：</p>
<p><img src="/2021/12/01/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86C3-%E5%9B%BE%E5%83%8F%E5%A2%9E%E5%BC%BA/C3_4.jpg"></p>
<h3 id="可分滤波器"><a href="#可分滤波器" class="headerlink" title="可分滤波器"></a>可分滤波器</h3><p>如果二维滤波器$w$能写成两个矩阵：分辨有$m$和$n$个元素的列向量$w_1$和行向量$w_2$相乘$w=w_1w_2$，那么它是可分的。且列向量乘行向量就等于它们做卷积。根据卷积结合律，$w \ast f = w_1 \ast w_2 \ast f$</p>
<p>直接卷积和分离卷积的复杂度分别为$MNmn$和$MN(m+n)$</p>
<p>根据矩阵理论，上面定义的可分滤波器的秩必为1，各行都是线性相关的，所以分解会很容易。</p>
<h3 id="空间域和频域的滤波对比"><a href="#空间域和频域的滤波对比" class="headerlink" title="空间域和频域的滤波对比"></a>空间域和频域的滤波对比</h3><p>第四章介绍的傅里叶变换是空间域和频域间转换的方法，频域和空间域的滤波有两种基本性质：</p>
<ol>
<li>空间域卷积等价于频域做乘法，反之亦然</li>
<li>空间域强度为$A$的脉冲是频域内的一个常量$A$，反之亦然</li>
</ol>
<p>图像可以分解为许多正弦函数的和，亮度变化缓慢的区域表现为较低频率的正弦函数，反之变化快的区域如边缘表现为较高频的正弦函数，因此削弱这部分会有助于模糊图像。</p>
<h3 id="构造滤波器的方法"><a href="#构造滤波器的方法" class="headerlink" title="构造滤波器的方法"></a>构造滤波器的方法</h3><ol>
<li>根据数学性质，如对邻域求均值可以类比成积分，会模糊图像，同理求导数能锐化图像</li>
<li>对一个有需要性质的二维函数进行采样，如高斯核可以做加权平均获得想要的模糊效果。</li>
<li>设计有特殊频率响应的滤波器。</li>
</ol>
<h2 id="低通滤波器"><a href="#低通滤波器" class="headerlink" title="低通滤波器"></a>低通滤波器</h2><p>低通滤波器可以用来削弱亮度的尖锐变化，因为噪音经常就是这种情况，所以低通滤波器经常用来降噪，另一个应用是轮廓检测前做预处理：除掉亮度等级太少的<em>false contours</em>。</p>
<h3 id="Box-Filter"><a href="#Box-Filter" class="headerlink" title="Box Filter"></a>Box Filter</h3><p>$m \times n$滤波器所有系数都为1，再全乘上常数$\frac{1}{mn}$，这种保证系数和为1的归一化手段会应用到本节所有滤波器。这样可以保证输出图像该区域均值和原图相等，且不会引入<em>bias</em>，即原图亮度和与输出相等。显然box滤波器</p>
<h3 id="低通高斯滤波器"><a href="#低通高斯滤波器" class="headerlink" title="低通高斯滤波器"></a>低通高斯滤波器</h3><p>boxfilter简单但很多场景下不适用，一种缺点是会倾向于沿着垂直方向模糊产生矩形效果。</p>
<p>高斯核是唯一可分且圆周对称<em>circularly symmetric</em>的核，既响应和旋转角度无关，表现在表达式可以写成只关于当前点到中心距离$r = (s^2+t^2)^{\frac{1}{2}}$的函数：</p>
<script type="math/tex; mode=display">
w(s,t) = Ke^{-\frac{s^2+t^2}{2\sigma^2}}=Ke^{-\frac{r^2}{2\sigma^2}} \quad (\text{letting } r^2=s^2+t^2)</script><p>$K$是用于归一化的常数。</p>
<p>由高斯分布的性质可知，距离中心大于$3\sigma$的值小到可以忽略不计，所以选定核大小为$\lceil 6\sigma\rceil\times \lceil 6\sigma\rceil $基本就能保留完整的高斯核特性。</p>
<p>高斯滤波结果会比boxfilter更平滑。</p>
<p>内容一样，尺寸越大的图片，要做到和较小图片同样程度的模糊效果，需要用到的滤波器越大。</p>
<p>使用大的高斯核利用其可分性质和分解的核运算节省的计算开销是可观的。</p>
<h3 id="Order-Statistic-Nonlinear-Filters"><a href="#Order-Statistic-Nonlinear-Filters" class="headerlink" title="Order-Statistic (Nonlinear) Filters"></a>Order-Statistic (Nonlinear) Filters</h3><p>这是一类非线性滤波器，响应取决于当前滤波器遇上邻域的统计信息。</p>
<p>以<em>median filter</em>为例，对当前邻域按亮度进行排序，将邻域中心的像素点亮度值替换为中位数。它能做到降噪效果好的同时不至于使图片过于模糊。</p>
<h2 id="高通滤波器"><a href="#高通滤波器" class="headerlink" title="高通滤波器"></a>高通滤波器</h2><p>平均可类比求导，能模糊图像。那么求微分自然就能锐化图像。</p>
<p>以离散一阶函数$f$为例，定义其导数和二阶导为：</p>
<script type="math/tex; mode=display">
\frac{\partial f}{\partial x} = f(x+1)-f(x) \\
\frac{\partial^2 f}{\partial x^2} = f(x+1)+f(x-1) - 2f(x)</script><p>图像中有许多渐变的部分，一阶导不为零，二阶导为零，二阶导会在过渡处产生非零点，边缘通常就在这种地方。而且实际上用卷积实现二阶导更容易。</p>
<p>现将以上导数定义推广到二维，最简单的<em>isotropic derivative operator</em>是拉普拉斯核$\nabla^2f = \frac{\partial^2}{\partial x^2} + \frac{\partial^2}{\partial y^2}$：</p>
<script type="math/tex; mode=display">
\frac{\partial^2 f}{\partial x^2} = f(x+1,y)+f(x-1,y) - 2f(x,y) \\
\frac{\partial^2 f}{\partial y^2} = f(x,y+1)+f(x,y-1) - 2f(x,y) \\
\nabla^2f(x,y) = f(x,y+1)+f(x,y-1)+f(x+1,y)+f(x-1,y) - 4f(x,y)</script><p>对应的拉普拉斯卷积核有两种，中心系数为正和中心系数为负的，下面默认使用中心系数为负的拉普拉斯核$l$：</p>
<script type="math/tex; mode=display">
\begin{matrix}
0 & 1 & 0 \\
1 & -4 & 1 \\
0 & 1 & 1
\end{matrix}</script><p>锐化表达式可写作：</p>
<script type="math/tex; mode=display">
g(x, y) = f(x, y) - l\ast f(x,y)</script><p>相当于利用局部的亮度不均放大了其对比度。</p>
<h3 id="Unsharp-Masking"><a href="#Unsharp-Masking" class="headerlink" title="Unsharp Masking"></a>Unsharp Masking</h3><p>另一种锐化手段：设模糊后的图片为$\bar{f}(x, y)$，可计算<em>unsharp mask</em>$g_{mask}=f(x,y)-\bar{f}(x,y)$，锐化图片为$g(x,y)=f(x,y) + kg_{mask}(x, y)$，取$k\geq1$时又叫<em>highboost filtering</em></p>
<h3 id="使用一阶导锐化图像"><a href="#使用一阶导锐化图像" class="headerlink" title="使用一阶导锐化图像"></a>使用一阶导锐化图像</h3><p>二维图像梯度的定义为</p>
<script type="math/tex; mode=display">
\nabla(f) = \begin{bmatrix} g_x \\ g_y \end{bmatrix} = \begin{bmatrix}\frac{\partial{f}}{\partial x}\\\frac{\partial{f}}{\partial y} \end{bmatrix}</script><p>该向量的方向是该点亮度变换最大的方向，大小可表示为$M(x,y)=|\nabla f(x,y)| = \sqrt{g_x^2+g_y^2}$，$M$就是原图像的梯度图。为简化计算用$M\approx |g_x|+|g_y|$近似。</p>
<p>实际计算梯度图也能用卷积近似，选用的滤波器又叫<em>Sobel operators</em>，中间系数为2是赋予其更高权重以制造平滑效果</p>
<script type="math/tex; mode=display">
\begin{bmatrix}
-1 & -2 & -1 \\
0 & 0 & 0 \\
1 & 2 & 1
\end{bmatrix}
\begin{bmatrix}
-1 & 0 & 1 \\
-2 & 0 & 2 \\
-1 & 0 & 1
\end{bmatrix}</script><p>梯度图经常用于检测瑕疵，或者作为自动检测程序的预处理，如下图光学镜片的梯度图凹陷边缘更为明显：</p>
<p><img src="/2021/12/01/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86C3-%E5%9B%BE%E5%83%8F%E5%A2%9E%E5%BC%BA/C3_5.jpg"></p>
<h2 id="带通滤波器，带阻滤波器"><a href="#带通滤波器，带阻滤波器" class="headerlink" title="带通滤波器，带阻滤波器"></a>带通滤波器，带阻滤波器</h2><p><img src="/2021/12/01/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86C3-%E5%9B%BE%E5%83%8F%E5%A2%9E%E5%BC%BA/C3_6.jpg"></p>
<p>高/低通滤波器变换到频域如上图所示。可以看出高通滤波器就等于常数1减去低通滤波器。前文提到频域中的常量1就相当于空间域的单位脉冲，因此可以用一个单位脉冲减去低通滤波器来构造高通滤波器，这正是Unsharp Masking的原理。</p>
<p>带通/带阻滤波器分别是只允许特定频段/只阻止特定频段的滤波器，构造逻辑类似</p>
<p><img src="/2021/12/01/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86C3-%E5%9B%BE%E5%83%8F%E5%A2%9E%E5%BC%BA/C3_7.jpg"></p>
<h1 id="结合不同的图像增强技术"><a href="#结合不同的图像增强技术" class="headerlink" title="结合不同的图像增强技术"></a>结合不同的图像增强技术</h1><p>下面以医学图像实例来体现结合增强技术的思路</p>
<p><img src="/2021/12/01/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86C3-%E5%9B%BE%E5%83%8F%E5%A2%9E%E5%BC%BA/C3_8.jpg"></p>
<p><img src="/2021/12/01/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86C3-%E5%9B%BE%E5%83%8F%E5%A2%9E%E5%BC%BA/C3_9.jpg"></p>
<p>以上图像编号为a-h。a是待增强图像，需要锐化和亮度变换提升细节。</p>
<p>直接使用<em>Sobel operator</em>得到的二阶导图如b，锐化结果见c，由于噪声较多所以效果不佳。</p>
<p>梯度图在渐变区域的响应高于二阶导，对噪音的响应和对细节的保留都低于二阶导，因此可以求出原图的梯度图d，对其使用低通滤波器降噪得到e，将e乘上二阶导b得到f，这步乘法可以看成是结合了二阶导和梯度图的优势：保留较强区域细节的同时削弱噪音，原图再加上f得到g，最后通过log变换（因为要铺开亮度分布所以$\gamma &lt; 1$）得到h。</p>
<h2 id="模糊集"><a href="#模糊集" class="headerlink" title="模糊集"></a>模糊集</h2><p>以后觉得有必要再补…</p>
<h1 id="风格化滤镜"><a href="#风格化滤镜" class="headerlink" title="风格化滤镜"></a>风格化滤镜</h1><p>下面贴一个风格化滤镜，抄群友的，卷积核为：</p>
<script type="math/tex; mode=display">
\begin{matrix}
-1 & -1 & -1 & -1 & -1 \\
-1 & -1 & -1 & -1 & -1 \\
-1 & -1 & 30 & -1 & -5 \\
-1 & -1 & -1 & -1 & -1 \\
-1 & -1 & -1 & -1 & -1 \\
\end{matrix}</script><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">painter_ink</span>(<span class="params">img, kernel</span>):</span></span><br><span class="line">    rst = cv2.filter2D(img, -<span class="number">1</span>, kernel).astype(np.float32)</span><br><span class="line">    rst = exp_transform(rst, <span class="number">2</span>) // exp_transform就是之前的exp变换</span><br><span class="line">    <span class="keyword">return</span> rst.astype(np.uint8)</span><br></pre></td></tr></table></figure>
<p>结果如下，clara那张先做了高斯模糊<br><img src="/2021/12/01/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86C3-%E5%9B%BE%E5%83%8F%E5%A2%9E%E5%BC%BA/C3_cheem_style.jpg"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/11/22/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86-C1-C2-%E5%AF%BC%E8%AE%BA%E4%B8%8E%E5%9F%BA%E7%A1%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="dmmaze">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ephemerallib">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/11/22/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86-C1-C2-%E5%AF%BC%E8%AE%BA%E4%B8%8E%E5%9F%BA%E7%A1%80/" class="post-title-link" itemprop="url">图像处理 C1-C2 导论与基础</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2021-11-22 18:50:13 / Modified: 19:00:10" itemprop="dateCreated datePublished" datetime="2021-11-22T18:50:13+08:00">2021-11-22</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86/" itemprop="url" rel="index"><span itemprop="name">图像处理</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="C1-Introduction"><a href="#C1-Introduction" class="headerlink" title="C1 - Introduction"></a>C1 - Introduction</h1><p>图像可以定义为亮度关于空间坐标$x, y$的函数$f(x, y)$，一张图像的基本元素是有限个由坐标和亮度定义的“亮点”，<strong>像素</strong>是这些元素最广泛的叫法。  </p>
<p>计算机处理图像可以分为三个层次：  </p>
<ul>
<li><strong>低阶处理</strong>涉及对图像的简单(primitive)操作，如降噪/锐化等预处理，特征是输入输出都是图像</li>
<li><strong>中阶处理</strong>输入是图像，输出是从中提取的某种属性，如边缘轮廓等。这一过程通常是为了其他任务提供方便，如提取出的边缘可能适合分类  </li>
<li><strong>高阶处理</strong>是解读出图像的“意义”，例子是图像分析以及与人类视觉相关的认知任务。  </li>
</ul>
<p>以文本识别为例，对文本图像的预处理，提取（分割）出字母并识别都在本书“图像处理”的范围内。  </p>
<p>早期的图像处理应用于太空任务，航天器摄像头拍摄到的图像会有这样那样的失真（distortion），需要进行校正。  </p>
<h2 id="数字图像处理的内容"><a href="#数字图像处理的内容" class="headerlink" title="数字图像处理的内容"></a>数字图像处理的内容</h2><h3 id="Image-acquisition"><a href="#Image-acquisition" class="headerlink" title="Image acquisition"></a>Image acquisition</h3><p>图像获取是第一步，第二章会进一步讨论数字图像来源，这一阶段通常涉及预处理，如缩放。  </p>
<h3 id="Image-enhancement"><a href="#Image-enhancement" class="headerlink" title="Image enhancement"></a>Image enhancement</h3><p>图像增强是处理图像使结果更有利于某一<strong>特定</strong>应用的手段。图像增强技术是<strong>问题导向</strong>的，适用于卫星图像的增强技术也许不适用于医学图像，效果如何并没有统一的评价标准，一般是主观的由观者评定。<br>2-4章介绍这部分内容。</p>
<h3 id="Image-restoration"><a href="#Image-restoration" class="headerlink" title="Image restoration"></a>Image restoration</h3><p>图像修复也是提升图像观感的手段，但不同于基于某种主观偏好的图像增强，这种技术是客观的，通常基于某种图像劣化的概率模型，</p>
<h3 id="Wavelets"><a href="#Wavelets" class="headerlink" title="Wavelets"></a>Wavelets</h3><p><em>不了解</em>见4-5章</p>
<h3 id="彩色图像处理"><a href="#彩色图像处理" class="headerlink" title="彩色图像处理"></a>彩色图像处理</h3><p>见第7章</p>
<h3 id="图像压缩"><a href="#图像压缩" class="headerlink" title="图像压缩"></a>图像压缩</h3><p><em>顾名思义</em></p>
<h3 id="Morphological-Processing"><a href="#Morphological-Processing" class="headerlink" title="Morphological Processing"></a>Morphological Processing</h3><p>形态学处理是提取提取出图像中有代表性和描述价值的部分</p>
<p><em>图像分割，特征提取，分类现在基本是dnn干的…</em> 读到后面有必要再看</p>
<h1 id="C2-数字图像基础"><a href="#C2-数字图像基础" class="headerlink" title="C2 - 数字图像基础"></a>C2 - 数字图像基础</h1><h2 id="视觉要素"><a href="#视觉要素" class="headerlink" title="视觉要素"></a>视觉要素</h2><p>对人类视觉特征，特别是物理限制的了解对图像处理任务有实践意义。<br><img src="/2021/11/22/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86-C1-C2-%E5%AF%BC%E8%AE%BA%E4%B8%8E%E5%9F%BA%E7%A1%80/C2-1.jpg" height="400">  </p>
<p>眼球是由外层的角膜<em>cornea</em>和巩膜<em>sclera</em>，内层脉络膜<em>choroid</em>，视网膜<em>retina</em>包住的近似球体。脉络膜就在角膜内一层，含有的血管是眼球营养物质的主要输送来源。脉络膜颜色较深，可减弱入眼的外界光。在其最外端又分为睫状体<em>ciliary</em>和虹膜<em>iris</em>，后者中央的开口（瞳孔）控制进入光线的多少。<br>眼睛的最内侧膜是视网膜，眼睛聚焦时物体光线就在视网膜上成像，视觉就是由视网膜上离散分布的光受体<em>light receptor</em>呈现的，这东西又分两种：视锥细胞<em>cones</em>和视杆细胞<em>rods</em>。眼睛一般有6-7百万视锥细胞，主要分布在视网膜中央的小凹<em>fovea</em>，对色彩高度敏感。视锥细胞都连接着各自的神经末梢，因而人能辨清较好的细节。视锥视觉又叫明视觉<em>photopic</em>。<br>视杆细胞数量更多达75-150百万，多个视杆细胞连接一个神经末梢，因而削弱了这些光感体可分辨细节的数量。视杆细胞捕捉视野范围内的整体图像，而且不参与彩色视觉，对低照明环境更敏感，所以日光下色彩鲜明的物体在月光下黯然失色，因为只有杆状细胞受刺激，这一现象又称暗视觉<em>scotopic</em>。</p>
<h2 id="亮度适应和区分"><a href="#亮度适应和区分" class="headerlink" title="亮度适应和区分"></a>亮度适应和区分</h2><p>人的视觉系统能适应的光线亮度范围很大，但人眼不能同时对整个可适应范围的不同亮度进行区分，在某一光照条件下其敏感范围（该范围内不同的亮度等级能被人眼区分）相对来说小得多。给定条件下当前视觉系统的敏感等级叫做<strong>亮度适应等级</strong><br><img src="/2021/11/22/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86-C1-C2-%E5%AF%BC%E8%AE%BA%E4%B8%8E%E5%9F%BA%E7%A1%80/C2-2.jpg" height="400">  </p>
<p>下面两种现象表明人眼<strong>感受到的</strong>亮度并非关于亮度的简单函数。  </p>
<p><img src="/2021/11/22/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86-C1-C2-%E5%AF%BC%E8%AE%BA%E4%B8%8E%E5%9F%BA%E7%A1%80/C2-3.jpg" height="400">   </p>
<p>图中色块都是纯色的，但人眼看来过渡处都要显得更暗/亮些，这种现象又叫马赫带效应<em>Mach bands</em>  </p>
<p>第二种现象叫同时对比<em>simultaneous contrast</em>，下面图像中央色块亮度相等，但对人眼背景明亮的色块显得稍暗些<br><img src="/2021/11/22/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86-C1-C2-%E5%AF%BC%E8%AE%BA%E4%B8%8E%E5%9F%BA%E7%A1%80/C2-4.jpg">   </p>
<h2 id="光和电磁光谱"><a href="#光和电磁光谱" class="headerlink" title="光和电磁光谱"></a>光和电磁光谱</h2><p><img src="/2021/11/22/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86-C1-C2-%E5%AF%BC%E8%AE%BA%E4%B8%8E%E5%9F%BA%E7%A1%80/C2-5.jpg">   </p>
<p>如图所示，可见光范围只占光谱的一小段。电磁光谱可以由波长 $\lambda$，频率$v$或者能量$E$表示，关系如下：  </p>
<script type="math/tex; mode=display">
\lambda =\frac{c}{v} \\
E = hv</script><p>$c$是光速，$h$是普朗克常量。电磁波可以看作传播的正弦波，也可视作无质量粒子流，这些粒子都带有特定量的能量，称作光子<em>photon</em>。高频电磁波每个光子携带能量更多。<br>可见光从紫到红波长在$0.43 - 0.79\mu m$内。某物的色彩是由其反射的光决定的，相对平衡地反射不同波长可见光的物体在观察者看来接近白色。<br>本书将没有颜色的光称作单色光<em>monochromic light（维基的解释是</em><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Monochrome"><em>所占波长段较短的光</em></a> <em>）</em>，唯一属性是灰度<em>gray level</em>或亮度intensity来描述。<br>彩光由三个属性描述：明度<em>brightness</em>是观察者感受到的明暗程度的主观度量，亮度<em>luminance</em>度量观察者从光源<em>观测到</em>的能量，辐亮度<em>radiance</em>度量光源流出的总能量。<br>数字图像生成来源除了电磁波辐射外，还可以是超声波，电子束或可视化软件等。  </p>
<h2 id="Image-Sensing-and-Acquisition"><a href="#Image-Sensing-and-Acquisition" class="headerlink" title="Image Sensing and Acquisition"></a>Image Sensing and Acquisition</h2><p>跳</p>
<h2 id="一个简单的图像构成模型"><a href="#一个简单的图像构成模型" class="headerlink" title="一个简单的图像构成模型"></a>一个简单的图像构成模型</h2><p>前文提到图像可看作亮度关于空间坐标$(x, y)$的函数，既$f(x, y)$，该函数又可写作照度$i$和反射率$r$的乘积:  </p>
<script type="math/tex; mode=display">
f(x, y) = i(x, y)r(x, y), 0 \leq i(x, y) \leq \infty, 0 \leq r(x, y) \leq 1</script><p>照度是由光源决定的，反射率由物体自身性质决定。黑天鹅绒是0.01，银是0.9，雪是0.93</p>
<h2 id="图像采样和量化"><a href="#图像采样和量化" class="headerlink" title="图像采样和量化"></a>图像采样和量化</h2><p>要生成数字图像，必须将传感器获取的连续传感数据（通常是连续的电压波形图，）转化到数字格式，采样<em>sampling</em>和量化<em>quantization</em>。<br>数字图像的坐标是离散点，对连续数据坐标的数字化称作采样，对其振幅<em>amplitude</em>(应该对应intensity)的数字化称作量化。<br>亮度级intensity level通常是数字化后的亮度数量：  </p>
<script type="math/tex; mode=display">
L = 2^k, k\in Z</script><p>离散的亮度级在范围$[0, L-1]$内。 图像的宽高也是有限整数，设为$M$和$N$。<br>存储图像需要的比特位数$b$：  </p>
<script type="math/tex; mode=display">
b = M \times N \times k</script><p>对于有$2^k$亮度等级的图像一般叫k-bit图</p>
<h2 id="空间和亮度分辨率-Spatial-and-Intensity-Resolution"><a href="#空间和亮度分辨率-Spatial-and-Intensity-Resolution" class="headerlink" title="空间和亮度分辨率 - Spatial and Intensity Resolution"></a>空间和亮度分辨率 - Spatial and Intensity Resolution</h2><p>分辨率图像中最小可分辨细节的度量单位，一般是单位长度内可排列的最大可分辨垂线对（黑白）数量，印刷业采用的是每英寸可分辨点数量，<em>Dots per inch</em>，报纸是133dpi。  </p>
<p>亮度分辨率指亮度等级最小的可分辨变化，一般是2的整数次幂，一般是以量化后存储的比特位数，最常见的是8比特（256亮度等级）。</p>
<p>下面例子描述了亮度/空间分辨率对图像质量的影响（<em>perceived quality</em>，由人对图像进行打分的主观质量）。</p>
<p><img src="/2021/11/22/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86-C1-C2-%E5%AF%BC%E8%AE%BA%E4%B8%8E%E5%9F%BA%E7%A1%80/C2-6.jpg"></p>
<p><img src="/2021/11/22/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86-C1-C2-%E5%AF%BC%E8%AE%BA%E4%B8%8E%E5%9F%BA%E7%A1%80/C2-7.jpg"></p>
<p>蓝色实线上的点主管质量相等，纵轴对应亮度分辨率，横轴是空间分辨率。对于内容较复杂的人群图片，亮度分辨率对主观质量的影响较小，而人脸对应简单内容的曲线，该曲线表明降低亮度分辨率可能造成质量提升（维持质量不变需要的空间分辨率减小了，最可能的原因是提升了对比度造成了观感提升）</p>
<h2 id="图像插值-Image-Interpolation"><a href="#图像插值-Image-Interpolation" class="headerlink" title="图像插值 - Image Interpolation"></a>图像插值 - Image Interpolation</h2><p>插值<em>Interpolation</em>是用已知数据估算未知数据。以图像放缩为例，将$500\times 500$ 放大到$750 \times 750$ ，可看作将原图切为$750 \times 750$网格，计算出每个网格点的值。</p>
<h2 id="像素间的基本关系"><a href="#像素间的基本关系" class="headerlink" title="像素间的基本关系"></a>像素间的基本关系</h2><h3 id="像素的近邻-Neighbors-of-a-Pixel"><a href="#像素的近邻-Neighbors-of-a-Pixel" class="headerlink" title="像素的近邻 - Neighbors of a Pixel"></a>像素的近邻 - Neighbors of a Pixel</h3><p>坐标$(x, y)$的像素点$p$上下左右近邻坐标为:  </p>
<script type="math/tex; mode=display">
N_4 = \{(x+1,y),(x-1,y),(x,y+1),(x,y-1)\}</script><p>这一集合叫$p$的<strong>四邻域</strong>，算上四个对角近邻集合：</p>
<script type="math/tex; mode=display">
N_D = \{(x+1,y+1),(x+1,y-1),(x-1,y+1),(x-1,y-1)\}</script><p>一共八个点构成了$p$的<strong>八邻域</strong>。如果邻域包含$p$就是<em>closed</em>否则$open$</p>
<h3 id="邻接，连通，区域和边界-Adjacency-Connectivity-Regions-and-Boundaries"><a href="#邻接，连通，区域和边界-Adjacency-Connectivity-Regions-and-Boundaries" class="headerlink" title="邻接，连通，区域和边界 - Adjacency, Connectivity, Regions, and Boundaries"></a>邻接，连通，区域和边界 - Adjacency, Connectivity, Regions, and Boundaries</h3><p>设$V$为所有亮度值的子集，对于$p, q$，$I(p), I(q)$分辨是它们对应亮度值满足$I(p)\in V, I(q) \in V$，那么两点的邻接性定义为：</p>
<ol>
<li><p>4邻接：$q \in N_4(p)$</p>
</li>
<li><p>8邻接：$q\in N_8(p)$</p>
</li>
<li><p>m邻接（m for mix），满足以下任意条件</p>
<p>a. $q \in N_4(p)$</p>
<p>b. $q \in N_D(p)$<strong>且</strong>$\forall pixel \in N_4(p) \cap N_4(q), I(pixel)\notin V$</p>
</li>
</ol>
<p>$p,q$间的<strong>路径</strong>指的是包括两点在内的点的有序集合($p$起始$q$结束)，集合内所有点都是唯一的，且相邻点是邻接的。<strong>路径长度</strong>就是集合点数-1。采用不同的连接性对应不同路径。</p>
<p>令$S$为图像所有像素点的子集，如果在$S$内存在一条连接$p, q$的路径，那么就说$p, q$在$S$内是连通的。对于$S$内任意点$p$，它的<strong>连通区域</strong> <em>connected component</em>是$S$内所有与$p$连通的点。如果$S$只有一个连通区域，$S$就是一个连通集<em>connected set</em>。</p>
<p>$R$是图像点的子集，如果$R$是一个连通集就称$R$是图像的一个<strong>区域</strong> <em>region</em>。对于两区域$R_i, R_j$如果它们的并是一个连通集，那么$R_j, R_i$是邻接关系。同样需要指定连接性。</p>
<p>规定$V$和连接性后可以求出一张图像的所有$K$个不碰边界且相互不相交的区域$R_k, k=1,2,\cdots ,K$，$R_u$是所有这些区域的并集，将$R_u$所有点成为前景<em>foreground</em>，它的补集就是背景<em>background</em>。</p>
<p>区域$R$的<strong>边界</strong> <em>boundary</em>（又称轮廓）是$R$内所有和$R$的补集（背景）邻接的像素。一般规定边界和背景是8连通性，且规定正好处于图像边界的点也属于区域边界。</p>
<p>边缘edge和边界常被混淆，可以将边界看作闭合路径，而边缘是亮度变化较大的点连成的线段。</p>
<h3 id="距离度量-Distance-Measures"><a href="#距离度量-Distance-Measures" class="headerlink" title="距离度量 - Distance Measures"></a>距离度量 - Distance Measures</h3><p>对于像素点$p(x,y), q(u,v), s(w,z)$，如果$D$满足以下条件，$D$就可称作距离函数或度量：</p>
<ol>
<li>$D(p, q)\geq 0 \quad (D(p,q)=0 \quad iff \quad p=q)$</li>
<li>$D(p, q) = D(q, p)$</li>
<li>$D(p, s) \leq D(p, q) + D(q, s)$</li>
</ol>
<p><em>欧几里得</em>距离：</p>
<script type="math/tex; mode=display">
D_e(p,q)=[(x-u)^2+(y-v)^2]^{\frac{1}{2}}</script><p>$D_4$距离又叫<em>city-block distance</em>：  </p>
<script type="math/tex; mode=display">
D_4(p, q) = |x-u|+|y-v|</script><script type="math/tex; mode=display">
\begin{matrix}
&& 2 \\
& 2 & 1 & 2 \\
2 & 1 & 0 & 1 & 2 \\
& 2 & 1 & 2 \\
&& 2
\end{matrix}</script><p>$D_8$距离又叫<em>chessboard distance</em>，距离为1的点属于中心点的$N_8$。：</p>
<script type="math/tex; mode=display">
D_8(p, q) = max(|x-u|, |y-v|)</script><script type="math/tex; mode=display">
\begin{matrix}
2 & 2 & 2 & 2 & 2 \\
2 & 1 & 1 & 1 & 2 \\
2 & 1 & 0 & 1 & 2 \\
2 & 1 & 1 & 1 & 2 \\
2 & 2 & 2 & 2 & 2
\end{matrix}</script><h2 id="一些基础的数学工具"><a href="#一些基础的数学工具" class="headerlink" title="一些基础的数学工具"></a>一些基础的数学工具</h2><h3 id="线性与非线性操作"><a href="#线性与非线性操作" class="headerlink" title="线性与非线性操作"></a>线性与非线性操作</h3><p>输入图像$f$，运算$\mathcal{H}(f(x,y)) = g(x,y)$如果对任意常数$a,b$满足：</p>
<script type="math/tex; mode=display">
\mathcal{H}(af_1(x,y), bf_2(x,y)) = ag_1(x,y) + bg_2(x,y)</script><p>就称$\mathcal{H}$是线性的，否则是非线性的。</p>
<h3 id="几何变换"><a href="#几何变换" class="headerlink" title="几何变换"></a>几何变换</h3><p>涉及修改图像中像素点的空间排布，如旋转扭曲等，由两步组成：</p>
<ol>
<li>坐标点的空间变换</li>
<li>对变换后像素点亮度的插值计算</li>
</ol>
<p>主要关注的是仿射变换，包括缩放，平移，旋转，切边等，且可以用<em>齐次坐标</em>统一用变换矩阵表示，具体见图形学相关内容。设$A$是某放射变换，$(x, y)$变换后的点是$(x’, y’)$：</p>
<script type="math/tex; mode=display">
\begin{bmatrix}
x' \\ y' \\1
\end{bmatrix} = 
A\begin{bmatrix}
x \\ y \\1
\end{bmatrix}</script><p>计算仿射变换时通常有两种方法：前向映射和后向映射。前向映射直接通过上式由原图点计算映射点，问题是原图多个点可能映射到变换图的同一个点上，也有可能变换图有的点映射不到。后向映射是计算变换图点对应在原图位置后再做插值。</p>
<h3 id="图像配准"><a href="#图像配准" class="headerlink" title="图像配准"></a>图像配准</h3><p>给定输入图像和参照图，对输入图进行几何变换使其和参照图对齐。</p>
<h3 id="图像变换"><a href="#图像变换" class="headerlink" title="图像变换"></a>图像变换</h3><p>对于输入图像$f(x,y)$，输出图$T(u,v)$，前向变换核<em>forward transformation kernel</em> $r(x,y,u,v)$，可以定义一种普遍的2D线性变换：</p>
<script type="math/tex; mode=display">
T(u,v) = \sum^{M-1}_{x=0}\sum^{N-1}_{y=0}f(x, y)r(x,y,u,v)</script><p>$T(u,v)$又称$f(x,y)$的前向变换，$f(x,y)$即$T(u,v)$的逆变换，$s(x,y,u,v)$是逆变换核：</p>
<script type="math/tex; mode=display">
f(x,y) = \sum^{M-1}_{u=0}\sum^{N-1}_{v=0}T(u, v)s(x,y,u,v)</script><p>如果$r(x,y,u,v)=r_1(x,u)r_2(y,v)$就是可分核，如果$r(x,y,u,v)=r_1(x,u)r_1(y,v)$就是对称核。</p>
<p>傅里叶变换的前向和后向核（可分且对称）为：</p>
<script type="math/tex; mode=display">
r(x,y,u,v) = e^{-j2\pi(ux/M+vy/N)} \\
r(x,y,u,v) = \frac{1}{MN}e^{j2\pi(ux/M+vy/N)}</script><p>以上两个公式在4章后尤为重要。</p>
<h3 id="随机变量"><a href="#随机变量" class="headerlink" title="随机变量"></a>随机变量</h3><p>随机变量<em>random variable</em>是将随机实验结果映射成实数值的<strong>函数</strong>。对于离散随机变量，其映射成的某个实值$z\in R$对应有概率函数$p(z)$，称作其<strong>概率质量函数</strong> <em>pmf</em>，满足以下性质：</p>
<script type="math/tex; mode=display">
1. \quad p(z) \geq 0, \forall z \in R \\
2. \quad \sum_{z\in R}p(z) = 1</script><p>累计分布函数<em>CDF</em>：</p>
<script type="math/tex; mode=display">
F(z) = \sum_{v\leq z}p(v)</script><p>以8比特图像为例，统计其255个亮度各自的像素数量，特别对某亮度$z$，像素数量为$h(z)$，图像分辨率为$MN$，那么其<em>pmf</em>：</p>
<script type="math/tex; mode=display">
p(z) = \frac{h(z)}{MN}</script><p>$h(z)$是该图像的非归一化直方图，$p(z)$是归一化直方图<em>normalized histogram</em>。</p>
<h3 id="离散随机变量的期望和动差"><a href="#离散随机变量的期望和动差" class="headerlink" title="离散随机变量的期望和动差"></a>离散随机变量的期望和动差</h3><p>$g(z)$是定义在离散随机变量$Z$映射结果$z$上的函数，$g(z)$的期望定义为：</p>
<script type="math/tex; mode=display">
E[g(z)] = \sum_{z\in R}g(z)p(z)</script><p>对图像令$g(z)=z$，上式即计算图像的亮度均值，均值一般记作$\mu$。</p>
<p>令$g(z) = (z-\mu)^2$，期望是图像亮度的方差，记作$\sigma^2$，标准差就是$\sigma$。</p>
<p>方差是均值动差<em>moment</em>的一种特例，这类函数写作$g(z)=(z-\mu)^n$，对应期望是$\mu_n$，亦称n阶动差。</p>
<h3 id="多元随机变量"><a href="#多元随机变量" class="headerlink" title="多元随机变量"></a>多元随机变量</h3><p>如果随机变量映射结果是个向量$\mathbf{z} \in R^n$，其期望定义为：</p>
<script type="math/tex; mode=display">
\bar{\mathbf{z}} = E(\mathbf{z}) = 
\begin{bmatrix}
E(z_1)\\ E(z_2)\\ \vdots \\ E(z_n)
\end{bmatrix}</script><p>其协方差矩阵是一个$n\times n$对称阵，定义为：</p>
<script type="math/tex; mode=display">
C = E[(\mathbf{z-\bar{z}})(\mathbf{z-\bar{z}})^T]</script><p>对于$C$中元素$c_{ij}=E[(\bar{z_i}-z_i)(\bar{z_j}-z_j)]$。$c_{ij}$就是$ij$处随机变量的协方差，$c_{ij}=0$则随机变量$Z_i,Z_j$不相关。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/10/07/02-04-%E7%BA%BF%E4%BB%A3%E5%9F%BA%E7%A1%80%EF%BC%8C%E5%8F%98%E6%8D%A2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="dmmaze">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ephemerallib">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/10/07/02-04-%E7%BA%BF%E4%BB%A3%E5%9F%BA%E7%A1%80%EF%BC%8C%E5%8F%98%E6%8D%A2/" class="post-title-link" itemprop="url">02-04-变换</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-10-07 18:59:33" itemprop="dateCreated datePublished" datetime="2021-10-07T18:59:33+08:00">2021-10-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-10-10 22:22:52" itemprop="dateModified" datetime="2021-10-10T22:22:52+08:00">2021-10-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6/" itemprop="url" rel="index"><span itemprop="name">计算机图形学</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6/games101notes/" itemprop="url" rel="index"><span itemprop="name">games101notes</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Transformation包括缩放，旋转，拉伸，为了引入平移后依然能通过矩阵乘法统一表示，引入齐次坐标系的概念。 仿射变换是线性变换加平移。  </p>
<h2 id="缩放"><a href="#缩放" class="headerlink" title="缩放"></a>缩放</h2><p>$s_x, s_y$分别对应$x,y$轴的缩放系数。将$s_x$设为-1可以得到对y轴翻转的效果</p>
<script type="math/tex; mode=display">
\begin{bmatrix}
x'\\ y'
\end{bmatrix} = 
\begin{bmatrix}
    s_x & 0 \\
    0 & s_y
\end{bmatrix}
\begin{bmatrix}
x \\ y 
\end{bmatrix}</script><h2 id="Shear-Matrix-切变"><a href="#Shear-Matrix-切变" class="headerlink" title="Shear Matrix - 切变"></a>Shear Matrix - 切变</h2><script type="math/tex; mode=display">
\begin{bmatrix}
x'\\ y'
\end{bmatrix} = 
\begin{bmatrix}
    1 & a \\
    0 & 1
\end{bmatrix}
\begin{bmatrix}
x \\ y 
\end{bmatrix}</script><h2 id="旋转"><a href="#旋转" class="headerlink" title="旋转"></a>旋转</h2><p><img src="/2021/10/07/02-04-%E7%BA%BF%E4%BB%A3%E5%9F%BA%E7%A1%80%EF%BC%8C%E5%8F%98%E6%8D%A2/c3-1.jpg" height="240"></p>
<p>以上变换都可以写成系数乘向量再相加的形式，既左乘一个系数矩阵，都是线性变换。引入平移后不能这么写。<br>为了使平移也能被一个系数矩阵表示，引入齐次坐标的概念。   </p>
<h2 id="齐次坐标系"><a href="#齐次坐标系" class="headerlink" title="齐次坐标系"></a>齐次坐标系</h2><p>在原向量基础上添一个w坐标：  </p>
<ul>
<li>2D point $= (x, y, 1)^T$</li>
<li>2D vector $= (x, y, 0)^T$  </li>
<li>规定$\begin{pmatrix}x \\ y \\ w\end{pmatrix}$等价于$\begin{pmatrix}x/w \\ y/w \\ 1\end{pmatrix}$<br>$w$位如上设置可以保留向量无固定起始点，两点之差等于向量等性质  <h3 id="平移"><a href="#平移" class="headerlink" title="平移"></a>平移</h3><script type="math/tex; mode=display">
\begin{pmatrix}
 x' \\ y' \\ 1
\end{pmatrix}=
\begin{pmatrix}
 1 & 0 & t_x \\
 0 & 1 & t_y \\
 0 & 0 & 1
\end{pmatrix}
\begin{pmatrix}
 x \\ y \\ z
\end{pmatrix}=
\begin{pmatrix}
 x + t_x\\
 y + t_y\\
 1
\end{pmatrix}</script></li>
</ul>
<h3 id="逆矩阵"><a href="#逆矩阵" class="headerlink" title="逆矩阵"></a>逆矩阵</h3><p>左乘逆矩阵可取消原矩阵的变换  </p>
<h2 id="变换组合"><a href="#变换组合" class="headerlink" title="变换组合"></a>变换组合</h2><p>对某一向量左乘多个变换矩阵，应用顺序是从右向左的。而且根据结合律可以看成左边所有系数矩阵相乘结果再乘以当前向量</p>
<h2 id="复杂变换的分解"><a href="#复杂变换的分解" class="headerlink" title="复杂变换的分解"></a>复杂变换的分解</h2><p>一个复杂变换同样可以分解成多个简单变换的组合<br><img src="/2021/10/07/02-04-%E7%BA%BF%E4%BB%A3%E5%9F%BA%E7%A1%80%EF%BC%8C%E5%8F%98%E6%8D%A2/c3-2.jpg" height="320">  </p>
<h2 id="3D变换"><a href="#3D变换" class="headerlink" title="3D变换"></a>3D变换</h2><p>齐次坐标系推广到三维形式:  </p>
<ul>
<li>3D point = $(x, y, z, 1)^T$</li>
<li>3D vector = $(x, y, z, 0)^T$</li>
</ul>
<h2 id="3D直角系绕某轴旋转"><a href="#3D直角系绕某轴旋转" class="headerlink" title="3D直角系绕某轴旋转"></a>3D直角系绕某轴旋转</h2><script type="math/tex; mode=display">
R_x(\alpha) = \begin{pmatrix}
    1 & 0 & 0 & 0 \\
    0 & \cos\alpha &-\sin\alpha & 0 \\
    0 & \sin\alpha & \cos\alpha & 0 \\
    0 & 0 & 0 & 1
\end{pmatrix} \\
R_y(\alpha) = \begin{pmatrix}
    \cos\alpha & 0 & \sin\alpha & 0 \\
    0 & 1 & 0 & 0 \\
    -\sin\alpha & 0 & \cos\alpha & 0 \\
    0 & 0 & 0 & 1
\end{pmatrix} \\
R_y(\alpha) = \begin{pmatrix}
    \cos\alpha & -\sin\alpha & 0 & 0 \\
    \sin\alpha & \cos\alpha & 0 & 0 \\
    0 & 0 & 1 & 0 \\
    0 & 0 & 0 & 1
\end{pmatrix} \\</script><p>任意旋转都可以分解为沿$xyz$轴的旋转组合  </p>
<h1 id="Viewing-transformation"><a href="#Viewing-transformation" class="headerlink" title="Viewing transformation"></a>Viewing transformation</h1><p>games101用拍照比喻从三维到二维的过程：  </p>
<ol>
<li>放置物体——模型变换</li>
<li>确定相机位置和朝向——相机/视图变换</li>
<li>拍照——三维到二维，投影变换<br>以上三个变换简称MVP变换  <h2 id="视图-相机变换"><a href="#视图-相机变换" class="headerlink" title="视图/相机变换"></a>视图/相机变换</h2>确定相机位置和观测角度的变换。<br>该变换首先需要定义相机：位置$\vec{e}$，观测方向$\hat{g}$，向上方向$\hat{t}$。<br>只要保证模型和相机的相对位置不变，那么观测结果也是不变的。因此可以将相机移到远点，同时对模型做相同的变换。<br>规定相机位置在原点，相机观测方向为$-z$方向，向上方向为$y$。<br>考虑相应的<strong>视图变换矩阵</strong>分解为平移+旋转$M_{view} = RT$，$T=\begin{pmatrix}<br>  1 &amp; 0 &amp; 0 &amp; -x_e\\<br>  0 &amp; 1 &amp; 0 &amp; -y_e\\<br>  0 &amp; 0 &amp; 1&amp; -z_e<br>\end{pmatrix}$。由于旋转矩阵是正交阵$R^T=R^{-1}$，所以$R$可以由它的逆矩阵的转置求得：<script type="math/tex; mode=display">
R^{-1} = \begin{bmatrix}
  x_{\hat{g}\times\hat{t}} & x_t & x_{-g} & 0 \\
  y_{\hat{g}\times\hat{t}} & y_t & y_{-g} & 0 \\
  z_{\hat{g}\times\hat{t}} & z_t & z_{-g} & 0 \\
  0 & 0 & 0 & 1 \\
\end{bmatrix} \Rightarrow R = \begin{bmatrix}
  x_{\hat{g}\times\hat{t}} & y_{\hat{g}\times\hat{t}} & z_{\hat{g}\times\hat{t}} & 0 \\ 
  x_t & y_t & g_t & 0\\
  x_{-g} & y_{-g} & z_{-g} & 0 \\
    0 & 0 & 0 & 1
\end{bmatrix}</script><img src="/2021/10/07/02-04-%E7%BA%BF%E4%BB%A3%E5%9F%BA%E7%A1%80%EF%BC%8C%E5%8F%98%E6%8D%A2/c3-3.jpg"> </li>
</ol>
<h2 id="投影变换"><a href="#投影变换" class="headerlink" title="投影变换"></a>投影变换</h2><h3 id="正交投影：Orthographic-projection"><a href="#正交投影：Orthographic-projection" class="headerlink" title="正交投影：Orthographic projection"></a>正交投影：Orthographic projection</h3><p>正交投影实际上是将空间立方体中心平移到原点，并将长宽高都挤压到区间[-1, 1]的过程，得到的立方体叫做<strong>canonical cube：正则/规范/标准立方体</strong>。<br>这一过程的变换矩阵同样可以分解为先平移再缩放：<br><img src="/2021/10/07/02-04-%E7%BA%BF%E4%BB%A3%E5%9F%BA%E7%A1%80%EF%BC%8C%E5%8F%98%E6%8D%A2/c3-4.jpg"><br>空间中的立方体可以由其六个面左右上下远近坐标来表示<br><img src="/2021/10/07/02-04-%E7%BA%BF%E4%BB%A3%E5%9F%BA%E7%A1%80%EF%BC%8C%E5%8F%98%E6%8D%A2/c3-5.jpg" height="224"></p>
<h3 id="透视投影：Perspective-Projection"><a href="#透视投影：Perspective-Projection" class="headerlink" title="透视投影：Perspective Projection"></a>透视投影：Perspective Projection</h3><p>透视投影遵循近小远大，相机的观测空间范围被称作<strong>视锥- frustum</strong>，一个由近小远大两平面夹成的空间，对应$z$值$z=n, z=f$通常会显示给出。<br>正交投影的思路是先将视锥压成长方体，再进行正交变换。想象近平面法线通过这一过程确实在远端变小“相交”了，从而获得了近小远大的透视效果。<br><img src="/2021/10/07/02-04-%E7%BA%BF%E4%BB%A3%E5%9F%BA%E7%A1%80%EF%BC%8C%E5%8F%98%E6%8D%A2/c3-6.jpg" height="200"><br>要解出对应的变换矩阵，需要找出变换前后点$(x, y, z),(x’,y’,z’)$的关系<br>根据三角相似可以知道变换前后$x, y$的缩放关系<br><img src="/2021/10/07/02-04-%E7%BA%BF%E4%BB%A3%E5%9F%BA%E7%A1%80%EF%BC%8C%E5%8F%98%E6%8D%A2/c3-7.jpg" height="200"> </p>
<script type="math/tex; mode=display">
M_{persp\rightarrow ortho}\begin{pmatrix}
    x \\ y \\ z \\ 1
\end{pmatrix} = \begin{pmatrix}
    nx \\ ny \\ unknown \\ z
\end{pmatrix} \Rightarrow M_{persp\rightarrow ortho} = \begin{pmatrix}
    n & 0 & 0 & 0 \\
    0 & n & 0 & 0 \\
    ? & ? & ? & ? \\
    0 & 0 & 1 & 0
\end{pmatrix}</script><p>该变换有以下特点：  </p>
<ul>
<li>近平面点$z$不会有变，任意点$z=n$，可知$z$值与$x, y$无关，可确定第三列为$\begin{pmatrix}<br>  0 &amp; 0 &amp; A &amp; B<br>  \end{pmatrix}$<br>  左乘变换矩阵后由于$w$坐标等于$n$，实际$z’=n^2$：<script type="math/tex; mode=display">
\begin{pmatrix}
  0 & 0 & A & B
\end{pmatrix}
\begin{pmatrix}
  x \\ y \\ n \\ 1
\end{pmatrix} = \begin{pmatrix}
  0 \\ 0 \\ n^2 \\ n
\end{pmatrix} \Rightarrow nA+B = n^2</script></li>
<li>同样远平面的$z$值也不变$z=f$，实际左乘变换矩阵后变为$f^2$<script type="math/tex; mode=display">
fA+B=f^2 \\
联立两式得  \\
A=n+f \quad
B = -nf</script>视锥由远近平面确定，一般给定nf，默认Z轴过两平面中点，再给出垂直方向的可视角度fovY和宽高比aspectratio，就可以计算出近平面的lrtb：<script type="math/tex; mode=display">
t = \tan{\frac{fovY}{2}} |n| \quad r = aspect * t</script><h2 id="思考题"><a href="#思考题" class="headerlink" title="思考题"></a>思考题</h2>平面$z=\frac{n+f}{2}$变远了还是变近了？<br>对于中点$\begin{pmatrix}<br>  0 \\ 0 \\ \frac{f+n}{2} \\ 1<br>\end{pmatrix}$，变换后为$\begin{pmatrix}0 \\ 0 \\ \frac{f^2+n^2}{2} \\ \frac{f+n}{2}\end{pmatrix}$可知$z/w$变大了，实际变近了。  </li>
</ul>
<h1 id="Assignment-1"><a href="#Assignment-1" class="headerlink" title="Assignment 1"></a>Assignment 1</h1><p>需要实现<br>get_model_matrix，返回一个旋转矩阵<br>get_projection_matrix，对应投影变换，既给定视锥远近平面$z$值，宽高比，fov，根据本节课给出的$M_{persp} = M_{ortho}M_{persp\rightarrow ortho}$返回投影变换矩阵。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/10/07/01-%E6%80%BB%E8%A7%88%EF%BC%8C%E7%BA%BF%E4%BB%A3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="dmmaze">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ephemerallib">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/10/07/01-%E6%80%BB%E8%A7%88%EF%BC%8C%E7%BA%BF%E4%BB%A3/" class="post-title-link" itemprop="url">01-总览，线代</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2021-10-07 18:58:33 / Modified: 22:26:44" itemprop="dateCreated datePublished" datetime="2021-10-07T18:58:33+08:00">2021-10-07</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6/" itemprop="url" rel="index"><span itemprop="name">计算机图形学</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6/games101notes/" itemprop="url" rel="index"><span itemprop="name">games101notes</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1X7411F744?">games101</a>课堂笔记</p>
<h1 id="Overview-of-CG"><a href="#Overview-of-CG" class="headerlink" title="Overview of CG"></a>Overview of CG</h1><p>The use of computers to synthesize and manipulate visual infomations.  </p>
<h2 id="Course-Topics"><a href="#Course-Topics" class="headerlink" title="Course Topics"></a>Course Topics</h2><ul>
<li>Rasterization<br>Project <strong>geometry primitives</strong>(几何基元/几何图元，如3D三角形/多边形) onto screen.  </li>
<li>Curves and Meshes<br>How to represent geometry in CG.  </li>
<li><p>Ray Tracing  </p>
</li>
<li><p>Animatino / Simulation</p>
</li>
</ul>
<h2 id="CG和CV区别"><a href="#CG和CV区别" class="headerlink" title="CG和CV区别"></a>CG和CV区别</h2><ul>
<li>CV涉及对图像内容的推断和对图像本身的处理，可看成从图像到模型，从图像到图像的过程    </li>
<li>CG主要是建模和仿真，可看成从模型到图像，从模型到模型的过程</li>
</ul>
<h1 id="Review-of-Linear-Algebra"><a href="#Review-of-Linear-Algebra" class="headerlink" title="Review of Linear Algebra"></a>Review of Linear Algebra</h1><h2 id="Vectors"><a href="#Vectors" class="headerlink" title="Vectors"></a>Vectors</h2><ul>
<li>usually written as $\vec{a}$ or $\mathbf{a}$, or start and end point $\vec{AB} = B-A$</li>
<li>有方向和长度，无绝对起始点  <h3 id="向量规范化-Normalization"><a href="#向量规范化-Normalization" class="headerlink" title="向量规范化-Normalization"></a>向量规范化-Normalization</h3>向量长度写作$|\vec{a}|$<br>规范化既将原向量缩放为长度为1的<strong>单位向量</strong>$\hat{a}=\vec{a}/|\vec{a}|$，结果可用来表示方向  </li>
</ul>
<h3 id="点乘与叉乘"><a href="#点乘与叉乘" class="headerlink" title="点乘与叉乘"></a>点乘与叉乘</h3><p><strong>点乘</strong>就是对应元素相乘再求和</p>
<script type="math/tex; mode=display">
\vec{a}\cdot\vec{b} = \begin{pmatrix}x_a \\ y_a \end{pmatrix} \cdot \begin{pmatrix}x_b \\ y_b \end{pmatrix} = x_ax_b + y_ay_b = \cos{\theta_{ab}}\|\vec{a}\|\|\vec{b}\|</script><ul>
<li>笛卡尔坐标系下的点乘结果可以看成一个向量在另一个向量上的投影长度。</li>
<li>根据点乘结果可以判断两方向的近似程度，根据正负号判断方向是否相反  </li>
</ul>
<p><strong>叉乘</strong>结果是一个与相乘向量正交的向量，方向根据选取坐标系而定，本课程默认右手系，二维直角系下$\vec{a}\times\vec{b}$，$\vec{a}$到$\vec{b}$为逆时针时方向朝外，为正否则朝内，为负  </p>
<ul>
<li>$\vec{a} \times \vec{b} = -\vec{b} \times \vec{a}$  </li>
<li>可以写成矩阵乘向量的形式<script type="math/tex; mode=display">
\vec{a} \times \vec{b} = Ab = 
\begin{pmatrix}0&-z_a&y_a \\
z_a & 0 & -x_a \\
-y_a & x_a & 0
\end{pmatrix}
\begin{pmatrix}
x_b \\ y_b \\ z_b
\end{pmatrix}</script></li>
<li>根据叉乘结果正负可以判断：  <ol>
<li>向量左右</li>
<li>判断点在多边形内外: 首尾相接向量成的多边形，一点$P$如与所有向量叉乘结果符号一致，则该点在多边形内部，否则在外部  </li>
</ol>
</li>
</ul>
<h2 id="矩阵乘法"><a href="#矩阵乘法" class="headerlink" title="矩阵乘法"></a>矩阵乘法</h2><ul>
<li>满足结合律，不满足交换律  </li>
<li>点乘叉乘都可以写成系数矩阵乘向量的形式，叉乘见上文，点乘:  <script type="math/tex; mode=display">
\mathbf{a} \cdot \mathbf{b} = \mathbf{a}^T\mathbf{b}</script></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">dmmaze</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">5</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">dmmaze</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
